"use strict";(self.webpackChunkpidvn_fe=self.webpackChunkpidvn_fe||[]).push([[6094],{76094:(Q,_,l)=>{l.r(_),l.d(_,{RelayDatecodeModule:()=>Y});var u=l(60177),h=l(46661),j=l(92887),v=l(47848),M=l(2578),e=l(54438),S=l(55442),E=l(37736),k=l(45794),c=l(89417),F=l(38296),C=l(31837),g=l(43053),s=l(23359),m=l(97529),y=l(50513),T=l(16389),I=l(25930),D=l(72874),R=l(21011),p=l(9541),f=l(1997);const x=["dateCodeIpt"],A=["qtyIpt"],b=()=>[""],V=()=>[10,25,50,100];function G(a,i){if(1&a&&e.nrm(0,"nz-option",39),2&a){const t=i.$implicit;e.Y8G("nzValue",t.qaCard)("nzLabel",t.qaCard)}}function O(a,i){1&a&&e.nrm(0,"i",40)}function B(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",41),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addDateCode())}),e.nrm(1,"i",42),e.EFF(2," Nh\u1eadp Code "),e.k0s()}}function P(a,i){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",43),e.EFF(6),e.nI1(7,"number"),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td",16)(13,"span",44),e.bIt("nzOnConfirm",function(){const n=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.deleteDatCode(n))}),e.EFF(14," X\xf3a "),e.k0s()()()}if(2&a){const t=i.$implicit;e.R7$(2),e.JRh(t.dateCode),e.R7$(2),e.JRh(t.customerCode),e.R7$(2),e.SpI(" ",e.i5U(7,5,t.qty,"1.0-3")," "),e.R7$(3),e.JRh(t.employeeName),e.R7$(2),e.JRh(t.remark)}}function N(a,i){if(1&a&&e.nrm(0,"nz-option",53),2&a){const t=i.$implicit;e.Y8G("nzLabel",t)("nzValue",t)}}function w(a,i){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"div",6)(2,"div",45)(3,"nz-table",46)(4,"tbody")(5,"tr")(6,"td")(7,"label"),e.EFF(8,"Customer Code"),e.k0s(),e.j41(9,"span",47),e.EFF(10,"\xa0(*)"),e.k0s()(),e.j41(11,"td")(12,"nz-select",48),e.mxI("ngModelChange",function(n){e.eBV(t);const d=e.XpG();return e.DH7(d.dateCodeSave.customerCode,n)||(d.dateCodeSave.customerCode=n),e.Njj(n)}),e.DNE(13,N,1,2,"nz-option",49),e.k0s()()(),e.j41(14,"tr")(15,"td")(16,"label"),e.EFF(17,"Date Code"),e.k0s(),e.j41(18,"span",47),e.EFF(19,"\xa0(*)"),e.k0s()(),e.j41(20,"td")(21,"input",50,3),e.mxI("ngModelChange",function(n){e.eBV(t);const d=e.XpG();return e.DH7(d.dateCodeSave.dateCode,n)||(d.dateCodeSave.dateCode=n),e.Njj(n)}),e.bIt("ngModelChange",function(n){e.eBV(t);const d=e.XpG();return e.Njj(d.onChangeDateCode(n))})("click",function(){e.eBV(t);const n=e.sdS(22);return e.Njj(n.select())}),e.k0s()()(),e.j41(23,"tr")(24,"td")(25,"label"),e.EFF(26,"Qty"),e.k0s(),e.j41(27,"span",47),e.EFF(28,"\xa0(*)"),e.k0s()(),e.j41(29,"td")(30,"input",51,4),e.mxI("ngModelChange",function(n){e.eBV(t);const d=e.XpG();return e.DH7(d.dateCodeSave.qty,n)||(d.dateCodeSave.qty=n),e.Njj(n)}),e.bIt("click",function(){e.eBV(t);const n=e.sdS(31);return e.Njj(n.select())}),e.k0s()()(),e.j41(32,"tr")(33,"td")(34,"label"),e.EFF(35,"Remark"),e.k0s()(),e.j41(36,"td")(37,"input",52),e.mxI("ngModelChange",function(n){e.eBV(t);const d=e.XpG();return e.DH7(d.dateCodeSave.remark,n)||(d.dateCodeSave.remark=n),e.Njj(n)}),e.k0s()()()()()()(),e.bVm()}if(2&a){const t=e.XpG();e.R7$(),e.Y8G("nzGutter",24),e.R7$(2),e.Y8G("nzData",e.lJ4(8,b)),e.R7$(9),e.R50("ngModel",t.dateCodeSave.customerCode),e.R7$(),e.Y8G("ngForOf",t.customerCodes),e.R7$(8),e.R50("ngModel",t.dateCodeSave.dateCode),e.Y8G("maxlength","RELAY"===t.area?7:20),e.R7$(9),e.R50("ngModel",t.dateCodeSave.qty),e.R7$(7),e.R50("ngModel",t.dateCodeSave.remark)}}function $(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCancel())}),e.EFF(1,"H\u1ee7y"),e.k0s(),e.j41(2,"button",55),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSave())}),e.EFF(3," L\u01b0u "),e.k0s()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("nzLoading",t.isLoading)}}const L=[{path:"",component:(()=>{class a{constructor(t,o,n,d){this.reDateCodeSvc=t,this.jwtHelperSvc=o,this.toastr=n,this.activatedRoute=d,this.qaCardInfo={model:null,line:null,date:"",shift:null,value:null},this.isOpenModal=!1,this.isLoading=!1,this.dateCodeSave={qaCard:null,dateCode:null,qty:0,userCode:0,model:null,line:null,date:new Date,shift:null,customerCode:null,recordType:null,remark:null}}ngOnInit(){this.area=this.activatedRoute.snapshot.queryParams.area,this.getAllDateCode()}ngAfterViewInit(){this.getQaCards()}getAllDateCode(){this.reDateCodeSvc.getAllDateCode().subscribe(t=>{console.log(t),this.dataSanXuat=t})}test(t){console.log("AAA : ",t)}scanInfo(t){let o=t;this.qaCardInfo.value=o;let n=o.split("*");this.qaCardInfo.model=n[0],this.qaCardInfo.line=n[1],this.qaCardInfo.date=n[2],this.qaCardInfo.shift=n[3],this.getDateCodes(o),this.getCustomerCodeByQACard(o)}getDateCodes(t){this.reDateCodeSvc.getDateCodes(t).subscribe(o=>{this.dateCodes=o})}getCustomerCodeByQACard(t){this.reDateCodeSvc.getQACardByValue(t).subscribe(o=>{console.log("getQACardByValue: ",o),this.customerCodes=o.customerCode,o.customerCode&&(this.customerCodes=o.customerCode.split(";"))})}onCancel(){this.resetModal(),this.isOpenModal=!1}onSave(){if(!this.dateCodeSave.dateCode||!this.dateCodeSave.qty)return void this.toastr.warning("C\u1ea7n nh\u1eadp DateCode; Qty","Warning");let t=this.isValidInputDateCode(this.area);t.isValid?(this.isLoading=!0,this.dateCodeSave.userCode=Number(this.jwtHelperSvc.decodeToken(localStorage.getItem("accessToken")?.toString()).UserId),this.dateCodeSave.qaCard=this.qaCardInfo.value,this.dateCodeSave.model=this.qaCardInfo.model,this.dateCodeSave.line=this.qaCardInfo.line,this.dateCodeSave.shift=this.qaCardInfo.shift,this.dateCodeSave.date=new Date(this.qaCardInfo.date),this.dateCodeSave.recordType=this.area,this.reDateCodeSvc.createDateCode(this.dateCodeSave).subscribe(o=>{this.toastr.success("Nh\u1eadp Date Code th\xe0nh c\xf4ng","OK"),this.resetModal(),this.getDateCodes(this.qaCardInfo.value),this.isOpenModal=!1,this.isLoading=!1},o=>{this.resetModal(),this.isLoading=!1})):this.toastr.warning(`${t.msg}`,"Warning")}isValidInputDateCode(t){return"RELAY"!==t||/[0-9](0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1])[A-Z][0-9]/.test(this.dateCodeSave.dateCode)?{isValid:!0,msg:"Date Code h\u1ee3p l\u1ec7"}:{isValid:!1,msg:"Date Code kh\xf4ng \u0111\xfang \u0111\u1ecbnh d\u1ea1ng"}}resetModal(){this.dateCodeSave.customerCode=null,this.dateCodeSave.dateCode=null,this.dateCodeSave.qty=0,this.dateCodeSave.remark=null}deleteDatCode(t){console.log("X\xf3a: ",t),this.reDateCodeSvc.deleteDateCode(t.id).subscribe(o=>{this.toastr.success("X\xf3a th\xe0nh c\xf4ng","OK"),this.getDateCodes(this.qaCardInfo.value)})}onChangeDateCode(t){this.dateCodeSave.dateCode=t.toUpperCase()}onExportClient(t){const o=new j.Workbook,n=o.addWorksheet("Main sheet");(0,v.V)({component:t.component,worksheet:n}).then(function(){o.xlsx.writeBuffer().then(function(d){M(new Blob([d],{type:"application/octet-stream"}),"M4M8-History.xlsx")})})}addDateCode(){5===this.qaCard.split("*").length&&this.qaCard.includes("*")?this.isOpenModal=!0:this.toastr.warning("QA card kh\xf4ng \u0111\xfang \u0111\u1ecbnh d\u1ea1ng","Warning")}getQaCards(){this.reDateCodeSvc.getQACards().subscribe(t=>{this.qaCards=t})}static#e=this.\u0275fac=function(o){return new(o||a)(e.rXU(S.U),e.rXU(E.X7),e.rXU(k.tw),e.rXU(h.nX))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-relay-datecode"]],viewQuery:function(o,n){if(1&o&&(e.GBs(x,5),e.GBs(A,5)),2&o){let d;e.mGM(d=e.lsd())&&(n.dateCodeIpt=d.first),e.mGM(d=e.lsd())&&(n.qtyIpt=d.first)}},decls:92,vars:28,consts:[["infoTbl",""],["suffixIconSearch",""],["dateCodeTbl",""],["dateCodeIpt",""],["qtyIpt",""],["nzTitle","Nh\u1eadp Date Code"],["nz-row","","nzJustify","start","nzAlign","middle",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","2"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","20"],["id","infoTbl","nzBordered","","nzSize","small","nzFrontPagination","false",3,"nzData"],[2,"color","black"],["colSpan","2"],["ngModel","lucy","nzShowSearch","","nzAllowClear","",3,"ngModelChange","ngModel"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["id","dateCodeTbl","nzBordered","","nzSize","small","nzFrontPagination","false",3,"nzData"],[2,"font-weight","bold"],[2,"text-align","center"],["nz-button","","nzType","primary",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["nzTitle","Nh\u1eadp Date Code cho QA card","nzWidth","650px",3,"nzVisibleChange","nzVisible"],[4,"nzModalContent"],[3,"nzModalFooter"],["nzTitle","D\u1eef li\u1ec7u s\u1ea3n xu\u1ea5t"],["keyExpr","id",3,"onExporting","dataSource","showColumnLines","showRowLines","showBorders","allowColumnResizing","columnAutoWidth","rowAlternationEnabled"],[3,"enabled"],[3,"visible"],["dataField","qaCard","caption","QA Card"],["dataField","dateCode","caption","Date Code"],["dataField","qty","caption","Qty","dataType","number","format","#,##0"],["dataField","model","caption","Model"],["dataField","line","caption","Line"],["dataField","shift","caption","Shift"],["dataField","employeeName","caption","User"],["dataField","recordType","caption","Record Type"],["dataField","customerCode","caption","Customer Code"],["dataField","createdAt","dataType","date","caption","Created At","format","yyyy-MM-dd HH:mm"],[3,"pageSize"],[3,"showPageSizeSelector","allowedPageSizes"],["nzTitle","D\u1eef li\u1ec7u Packing"],[3,"nzValue","nzLabel"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],[2,"text-align","right"],["nz-popconfirm","","nzPopconfirmTitle","B\u1ea1n ch\u1eafc ch\u1eafn x\xf3a Date Code n\xe0y ?",1,"delete",3,"nzOnConfirm"],["nz-col","","nzXs","24","nzSm","24","nzLg","24"],["id","addTbl","nzBordered","","nzSize","small","nzFrontPagination","false",3,"nzData"],[2,"color","red"],["nzPlaceHolder","Customer Code","nzShowSearch","","nzAllowClear","",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-input","","placeholder","Date Code",3,"ngModelChange","click","ngModel","maxlength"],["nz-input","","type","number","placeholder","Qty",3,"ngModelChange","click","ngModel"],["nz-input","","placeholder","Ghi ch\xfa",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click","nzLoading"]],template:function(o,n){if(1&o){const d=e.RV6();e.j41(0,"nz-tabset")(1,"nz-tab",5)(2,"div",6),e.nrm(3,"div",7),e.j41(4,"div",8)(5,"nz-table",9,0)(7,"thead")(8,"tr")(9,"th")(10,"label",10),e.EFF(11,"QA Card"),e.k0s()(),e.j41(12,"th",11)(13,"nz-select",12),e.mxI("ngModelChange",function(r){return e.eBV(d),e.DH7(n.qaCard,r)||(n.qaCard=r),e.Njj(r)}),e.bIt("ngModelChange",function(){return e.eBV(d),e.Njj(n.scanInfo(n.qaCard))}),e.DNE(14,G,1,2,"nz-option",13),e.k0s(),e.DNE(15,O,1,0,"ng-template",null,1,e.C5r),e.k0s(),e.j41(17,"th")(18,"label"),e.EFF(19,"Code:"),e.k0s(),e.EFF(20,"\xa0"),e.j41(21,"span"),e.EFF(22),e.k0s()()()(),e.j41(23,"tbody")(24,"tr")(25,"td")(26,"label"),e.EFF(27,"Model:"),e.k0s(),e.EFF(28,"\xa0"),e.j41(29,"span"),e.EFF(30),e.k0s()(),e.j41(31,"td")(32,"label"),e.EFF(33,"Line:"),e.k0s(),e.EFF(34,"\xa0"),e.j41(35,"span"),e.EFF(36),e.k0s()(),e.j41(37,"td")(38,"label"),e.EFF(39,"Date:"),e.k0s(),e.EFF(40,"\xa0"),e.j41(41,"span"),e.EFF(42),e.k0s()(),e.j41(43,"td")(44,"label"),e.EFF(45,"Shift:"),e.k0s(),e.EFF(46,"\xa0"),e.j41(47,"span"),e.EFF(48),e.k0s()()()()()(),e.nrm(49,"div",7),e.k0s(),e.j41(50,"div",6),e.nrm(51,"div",7),e.j41(52,"div",8)(53,"nz-table",14,2)(55,"thead")(56,"tr")(57,"th",15),e.EFF(58,"Date Code"),e.k0s(),e.j41(59,"th",15),e.EFF(60,"Cus Code"),e.k0s(),e.j41(61,"th",15),e.EFF(62,"Qty"),e.k0s(),e.j41(63,"th",15),e.EFF(64,"Ng\u01b0\u1eddi t\u1ea1o"),e.k0s(),e.j41(65,"th",15),e.EFF(66,"Remark"),e.k0s(),e.j41(67,"th",16),e.DNE(68,B,3,0,"button",17),e.k0s()()(),e.j41(69,"tbody"),e.DNE(70,P,15,8,"tr",18),e.k0s()()(),e.nrm(71,"div",7),e.k0s(),e.j41(72,"nz-modal",19),e.mxI("nzVisibleChange",function(r){return e.eBV(d),e.DH7(n.isOpenModal,r)||(n.isOpenModal=r),e.Njj(r)}),e.DNE(73,w,38,9,"ng-container",20)(74,$,4,1,"ng-template",21),e.k0s()(),e.j41(75,"nz-tab",22)(76,"dx-data-grid",23),e.bIt("onExporting",function(r){return e.eBV(d),e.Njj(n.onExportClient(r))}),e.nrm(77,"dxo-export",24)(78,"dxo-filter-row",25)(79,"dxi-column",26)(80,"dxi-column",27)(81,"dxi-column",28)(82,"dxi-column",29)(83,"dxi-column",30)(84,"dxi-column",31)(85,"dxi-column",32)(86,"dxi-column",33)(87,"dxi-column",34)(88,"dxi-column",35)(89,"dxo-paging",36)(90,"dxo-pager",37),e.k0s()(),e.nrm(91,"nz-tab",38),e.k0s()}if(2&o){const d=e.sdS(54);e.R7$(2),e.Y8G("nzGutter",24),e.R7$(3),e.Y8G("nzData",e.lJ4(26,b)),e.R7$(8),e.R50("ngModel",n.qaCard),e.R7$(),e.Y8G("ngForOf",n.qaCards),e.R7$(8),e.JRh(n.customerCodes),e.R7$(8),e.JRh(n.qaCardInfo.model),e.R7$(6),e.JRh(n.qaCardInfo.line),e.R7$(6),e.JRh(n.qaCardInfo.date),e.R7$(6),e.JRh(n.qaCardInfo.shift),e.R7$(2),e.Y8G("nzGutter",24),e.R7$(3),e.Y8G("nzData",n.dateCodes),e.R7$(15),e.Y8G("ngIf",n.qaCardInfo.value),e.R7$(2),e.Y8G("ngForOf",d.data),e.R7$(2),e.R50("nzVisible",n.isOpenModal),e.R7$(4),e.Y8G("dataSource",n.dataSanXuat)("showColumnLines",!0)("showRowLines",!0)("showBorders",!0)("allowColumnResizing",!0)("columnAutoWidth",!0)("rowAlternationEnabled",!0),e.R7$(),e.Y8G("enabled",!0),e.R7$(),e.Y8G("visible",!0),e.R7$(11),e.Y8G("pageSize",10),e.R7$(),e.Y8G("showPageSizeSelector",!0)("allowedPageSizes",e.lJ4(27,V))}},dependencies:[u.Sq,u.bT,c.me,c.Q0,c.BC,c.tU,c.vS,F.s,C.nj_,C.ZJU,C.FTx,C.sVQ,C.PVd,g.F2,g.Oj,g.A9,s.CP,s.SO,s._4,s.IL,s.aj,s.kt,m.Uq,m.e,y.aO,T.c,I.p,D.PV,R.Sy,p.JZ,p.rE,f.ld,f.WI,u.QX],styles:["nz-table[_ngcontent-%COMP%]{width:100%}#infoTbl[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#00f}#infoTbl[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;color:green}#infoTbl[_ngcontent-%COMP%]   nz-select[_ngcontent-%COMP%]{width:100%}#dateCodeTbl[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%]{color:#00f}#dateCodeTbl[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{color:red}#dateCodeTbl[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%]:hover, #dateCodeTbl[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]:hover{cursor:pointer}#addTbl[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#00f}#addTbl[_ngcontent-%COMP%]   nz-select[_ngcontent-%COMP%]{width:100%}"]})}return a})()}];let X=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.$C({type:a});static#n=this.\u0275inj=e.G2t({imports:[h.iI.forChild(L),h.iI]})}return a})();var q=l(31958);let Y=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.$C({type:a});static#n=this.\u0275inj=e.G2t({imports:[u.MD,c.YN,X,F.N,q.EJ,g.U6,s.$G,m.f3,y.Zw,D.g9,R.j,p.hM,f.DH]})}return a})()}}]);