"use strict";(self.webpackChunkpidvn_fe=self.webpackChunkpidvn_fe||[]).push([[7907],{87907:(ye,G,s)=>{s.d(G,{X:()=>ge});var a=s(54438),y=s(24292),A=s(91269),X=s(12984),J=s(64905),f=s(87310),L=s(23862),Q=s(98041),T=s(48745),h=s(12101),C=s(87951),S=s(89518),v=s(72463),D=s(49104),Y=s(24159),R=s(80186),B=s(56221),p=B.A.abstract;const E=B.A.inherit({_defaultRouteWeight:function(){return 5},_defaultRouteOpacity:function(){return.5},_defaultRouteColor:function(){return"#0000FF"},ctor:function(e,t){this._mapWidget=e,this._$container=t},render:function(e,t){return this._renderImpl().then(function(){return Promise.all([this._applyFunctionIfNeeded("addMarkers",e),this._applyFunctionIfNeeded("addRoutes",t)]).then(function(){return!0})}.bind(this))},_renderImpl:p,updateDimensions:p,updateMapType:p,updateBounds:p,updateCenter:p,updateZoom:p,updateControls:p,updateMarkers:function(e,t){return new Promise(function(n){return this._applyFunctionIfNeeded("removeMarkers",e).then(function(i){this._applyFunctionIfNeeded("addMarkers",t).then(function(o){n(o||i)})}.bind(this))}.bind(this))},addMarkers:p,removeMarkers:p,adjustViewport:p,updateRoutes:function(e,t){return new Promise(function(n){return this._applyFunctionIfNeeded("removeRoutes",e).then(function(i){this._applyFunctionIfNeeded("addRoutes",t).then(function(o){n(o||i)})}.bind(this))}.bind(this))},addRoutes:p,removeRoutes:p,clean:p,map:function(){return this._map},isEventsCanceled:function(){return!1},_option:function(e,t){if(void 0===t)return this._mapWidget.option(e);this._mapWidget.setOptionSilent(e,t)},_keyOption:function(e){var t=this._option("apiKey");return void 0===t[e]?t:t[e]},_parseTooltipOptions:function(e){return{text:e.text||e,visible:e.isShown||!1}},_getLatLng:function(e){if("string"==typeof e){var t=(0,h.Tj)(e.split(","),function(i){return i.trim()}),n=/^[-+]?[0-9]*\.?[0-9]*$/;if(2===t.length&&t[0].match(n)&&t[1].match(n))return{lat:parseFloat(t[0]),lng:parseFloat(t[1])}}else{if(Array.isArray(e)&&2===e.length)return{lat:e[0],lng:e[1]};if((0,v.Qd)(e)&&(0,v.kf)(e.lat)&&(0,v.kf)(e.lng))return e}return null},_areBoundsSet:function(){return this._option("bounds.northEast")&&this._option("bounds.southWest")},_addEventNamespace:function(e){return(0,D.b4)(e,this._mapWidget.NAME)},_applyFunctionIfNeeded:function(e,t){return t.length?this[e](t):Promise.resolve()},_fireAction:function(e,t){this._mapWidget._createActionByOption(e)(t)},_fireClickAction:function(e){this._fireAction("onClick",e)},_fireMarkerAddedAction:function(e){this._fireAction("onMarkerAdded",e)},_fireMarkerRemovedAction:function(e){this._fireAction("onMarkerRemoved",e)},_fireRouteAddedAction:function(e){this._fireAction("onRouteAdded",e)},_fireRouteRemovedAction:function(e){this._fireAction("onRouteRemoved",e)}});var x=s(34090),z=s(18060);const ne=E.inherit({_locationToString:function(e){var t=this._getLatLng(e);return t?t.lat+","+t.lng:e.toString().replace(/ /g,"+")},_renderImpl:function(){return this._updateMap()},updateDimensions:function(){return this._updateMap()},updateMapType:function(){return this._updateMap()},updateBounds:function(){return Promise.resolve()},updateCenter:function(){return this._updateMap()},updateZoom:function(){return this._updateMap()},updateControls:function(){return Promise.resolve()},addMarkers:function(e){var t=this;return this._updateMap().then(function(n){return(0,h.__)(e,function(i,o){t._fireMarkerAddedAction({options:o})}),n})},removeMarkers:function(e){var t=this;return this._updateMap().then(function(n){return(0,h.__)(e,function(i,o){t._fireMarkerRemovedAction({options:o})}),n})},adjustViewport:function(){return Promise.resolve()},addRoutes:function(e){var t=this;return this._updateMap().then(function(n){return(0,h.__)(e,function(i,o){t._fireRouteAddedAction({options:o})}),n})},removeRoutes:function(e){var t=this;return this._updateMap().then(function(n){return(0,h.__)(e,function(i,o){t._fireRouteRemovedAction({options:o})}),n})},clean:function(){return this._$container.css("backgroundImage","none"),A.A.off(this._$container,this._addEventNamespace(z.U)),Promise.resolve()},mapRendered:function(){return!0},_updateMap:function(){var e=this._keyOption("googleStatic"),t=this._$container,n=["sensor=false","size="+Math.round((0,R.RG)(t))+"x"+Math.round((0,R.Oq)(t)),"maptype="+this._option("type"),"center="+this._locationToString(this._option("center")),"zoom="+this._option("zoom"),this._markersSubstring()];n.push.apply(n,this._routeSubstrings()),e&&n.push("key="+e);var i="https://maps.google.com/maps/api/staticmap?"+n.join("&");return this._$container.css("background",'url("'+i+'") no-repeat 0 0'),this._attachClickEvent(),Promise.resolve(!0)},_markersSubstring:function(){var e=this,t=[],n=this._option("markerIconSrc");return n&&t.push("icon:"+n),(0,h.__)(this._option("markers"),function(i,o){t.push(e._locationToString(o.location))}),"markers="+t.join("|")},_routeSubstrings:function(){var e=this,t=[];return(0,h.__)(this._option("routes"),function(n,i){var o=new x.A(i.color||e._defaultRouteColor()).toHex().replace("#","0x"),r=Math.round(255*(i.opacity||e._defaultRouteOpacity())).toString(16),d=i.weight||e._defaultRouteWeight(),u=[];(0,h.__)(i.locations,function(l,g){u.push(e._locationToString(g))}),t.push("path=color:"+o+r+"|weight:"+d+"|"+u.join("|"))}),t},_attachClickEvent:function(){var e=this,t=this._addEventNamespace(z.U);A.A.off(this._$container,t),A.A.on(this._$container,t,function(n){e._fireClickAction({event:n})})}});var W=s(14435),H=s(5042),m=E.abstract;const $=E.inherit({_geocodeLocation:function(e){return new Promise(function(t){var n=this._geocodedLocations,i=n[e];i?t(i):this._geocodeLocationImpl(e).then(function(o){n[e]=o,t(o)})}.bind(this))},_renderImpl:function(){return this._load().then(function(){return this._init()}.bind(this)).then(function(){return Promise.all([this.updateMapType(),this._areBoundsSet()?this.updateBounds():this.updateCenter()])}.bind(this)).then(function(){return this._attachHandlers(),new Promise(function(e){var t=setTimeout(function(){clearTimeout(t),e()})})}.bind(this))},_load:function(){return this._mapsLoader||(this._mapsLoader=this._loadImpl()),this._markers=[],this._routes=[],this._mapsLoader},_loadImpl:m,_init:m,_attachHandlers:m,addMarkers:function(e){return Promise.all((0,h.Tj)(e,function(t){return this._addMarker(t)}.bind(this))).then(function(t){return this._fitBounds(),[!1,(0,h.Tj)(t,function(n){return n.marker})]}.bind(this))},_addMarker:function(e){return this._renderMarker(e).then(function(t){return this._markers.push((0,C.X)({options:e},t)),this._fireMarkerAddedAction({options:e,originalMarker:t.marker}),t}.bind(this))},_renderMarker:m,removeMarkers:function(e){var t=this;return(0,h.__)(e,function(n,i){t._removeMarker(i)}),Promise.resolve()},_removeMarker:function(e){var t=this;(0,h.__)(this._markers,function(n,i){return i.options!==e||(t._destroyMarker(i),t._markers.splice(n,1),t._fireMarkerRemovedAction({options:i.options}),!1)})},_destroyMarker:m,_clearMarkers:function(){for(;this._markers.length>0;)this._removeMarker(this._markers[0].options)},addRoutes:function(e){return Promise.all((0,h.Tj)(e,function(t){return this._addRoute(t)}.bind(this))).then(function(t){return this._fitBounds(),[!1,(0,h.Tj)(t,function(n){return n.instance})]}.bind(this))},_addRoute:function(e){return this._renderRoute(e).then(function(t){return this._routes.push((0,C.X)({options:e},t)),this._fireRouteAddedAction({options:e,originalRoute:t.instance}),t}.bind(this))},_renderRoute:m,removeRoutes:function(e){var t=this;return(0,h.__)(e,function(n,i){t._removeRoute(i)}),Promise.resolve()},_removeRoute:function(e){var t=this;(0,h.__)(this._routes,function(n,i){return i.options!==e||(t._destroyRoute(i),t._routes.splice(n,1),t._fireRouteRemovedAction({options:e}),!1)})},_destroyRoute:m,_clearRoutes:function(){for(;this._routes.length>0;)this._removeRoute(this._routes[0].options)},adjustViewport:function(){return this._fitBounds()},isEventsCanceled:function(){return!0},_fitBounds:m,_updateBounds:function(){var e=this;this._clearBounds(),this._option("autoAdjust")&&((0,h.__)(this._markers,function(t,n){e._extendBounds(n.location)}),(0,h.__)(this._routes,function(t,n){n.northEast&&e._extendBounds(n.northEast),n.southWest&&e._extendBounds(n.southWest)}))},_clearBounds:function(){this._bounds=null},_extendBounds:m});var M,I,N=s(94461),b=(0,W.zk)(),w="_googleScriptReady",oe="https://maps.googleapis.com/maps/api/js?callback="+w,K=function(){return b.google&&b.google.maps};const he=$.inherit({_mapType:function(e){var t={hybrid:google.maps.MapTypeId.HYBRID,roadmap:google.maps.MapTypeId.ROADMAP,satellite:google.maps.MapTypeId.SATELLITE};return t[e]||t.hybrid},_movementMode:function(e){var t={driving:google.maps.TravelMode.DRIVING,walking:google.maps.TravelMode.WALKING};return t[e]||t.driving},_resolveLocation:function(e){return new Promise(function(t){var n=this._getLatLng(e);n?t(new google.maps.LatLng(n.lat,n.lng)):this._geocodeLocation(e).then(function(i){t(i)})}.bind(this))},_geocodedLocations:{},_geocodeLocationImpl:function(e){return new Promise(function(t){(0,v.O9)(e)?(new google.maps.Geocoder).geocode({address:e},function(i,o){o===google.maps.GeocoderStatus.OK?t(i[0].geometry.location):(f.A.log("W1006",o),t(new google.maps.LatLng(0,0)))}):t(new google.maps.LatLng(0,0))})},_normalizeLocation:function(e){return{lat:e.lat(),lng:e.lng()}},_normalizeLocationRect:function(e){return{northEast:this._normalizeLocation(e.getNorthEast()),southWest:this._normalizeLocation(e.getSouthWest())}},_loadImpl:function(){return new Promise(function(e){K()?e():(I||(I=this._loadMapScript()),I.then(function(){K()?e():this._loadMapScript().then(e)}.bind(this)))}.bind(this)).then(function(){(M=function(e){this._position=e.position,this._offset=e.offset,this._$overlayContainer=(0,y.A)("<div>").css({position:"absolute",display:"none",cursor:"pointer"}).append(e.html),this.setMap(e.map)}).prototype=new google.maps.OverlayView,M.prototype.onAdd=function(){(0,y.A)(this.getPanes().overlayMouseTarget).append(this._$overlayContainer),this._clickListener=google.maps.event.addDomListener(this._$overlayContainer.get(0),"click",function(t){google.maps.event.trigger(this,"click"),t.preventDefault()}.bind(this)),this.draw()},M.prototype.onRemove=function(){google.maps.event.removeListener(this._clickListener),this._$overlayContainer.remove()},M.prototype.draw=function(){var e=this.getProjection().fromLatLngToDivPixel(this._position);this._$overlayContainer.css({left:e.x+this._offset.left,top:e.y+this._offset.top,display:"block"})}})},_loadMapScript:function(){return new Promise(function(e){var t=this._keyOption("google");b[w]=e,N.A.sendRequest({url:oe+(t?"&key="+t:""),dataType:"script"})}.bind(this)).then(function(){try{delete b[w]}catch{b[w]=void 0}})},_init:function(){return new Promise(function(e){this._resolveLocation(this._option("center")).then(function(t){var n=this._option("controls");this._map=new google.maps.Map(this._$container[0],{zoom:this._option("zoom"),center:t,disableDefaultUI:!n});var i=google.maps.event.addListener(this._map,"idle",function(){e(i)})}.bind(this))}.bind(this)).then(function(e){google.maps.event.removeListener(e)})},_attachHandlers:function(){this._boundsChangeListener=google.maps.event.addListener(this._map,"bounds_changed",this._boundsChangeHandler.bind(this)),this._clickListener=google.maps.event.addListener(this._map,"click",this._clickActionHandler.bind(this))},_boundsChangeHandler:function(){var e=this._map.getBounds();this._option("bounds",this._normalizeLocationRect(e));var t=this._map.getCenter();this._option("center",this._normalizeLocation(t)),this._preventZoomChangeEvent||this._option("zoom",this._map.getZoom())},_clickActionHandler:function(e){this._fireClickAction({location:this._normalizeLocation(e.latLng)})},updateDimensions:function(){var e=this._option("center");return google.maps.event.trigger(this._map,"resize"),this._option("center",e),this.updateCenter()},updateMapType:function(){return this._map.setMapTypeId(this._mapType(this._option("type"))),Promise.resolve()},updateBounds:function(){return Promise.all([this._resolveLocation(this._option("bounds.northEast")),this._resolveLocation(this._option("bounds.southWest"))]).then(function(e){var t=new google.maps.LatLngBounds;t.extend(e[0]),t.extend(e[1]),this._map.fitBounds(t)}.bind(this))},updateCenter:function(){return this._resolveLocation(this._option("center")).then(function(e){this._map.setCenter(e),this._option("center",this._normalizeLocation(e))}.bind(this))},updateZoom:function(){return this._map.setZoom(this._option("zoom")),Promise.resolve()},updateControls:function(){var e=this._option("controls");return this._map.setOptions({disableDefaultUI:!e}),Promise.resolve()},isEventsCanceled:function(e){var t=this._map&&this._map.get("gestureHandling");return!((0,y.A)(e.target).closest(".".concat("gm-style-iw")).length>0||"desktop"!==L.A.real().deviceType&&"cooperative"===t)&&this.callBase()},_renderMarker:function(e){return this._resolveLocation(e.location).then(function(t){var n;n=e.html?new M({map:this._map,position:t,html:e.html,offset:(0,C.X)({top:0,left:0},e.htmlOffset)}):new google.maps.Marker({position:t,map:this._map,icon:e.iconSrc||this._option("markerIconSrc")});var o,i=this._renderTooltip(n,e.tooltip);if(e.onClick||e.tooltip){var r=this._mapWidget._createAction(e.onClick||H.lQ),d=this._normalizeLocation(t);o=google.maps.event.addListener(n,"click",function(){r({location:d}),i&&i.open(this._map,n)}.bind(this))}return{location:t,marker:n,listener:o}}.bind(this))},_renderTooltip:function(e,t){if(t){t=this._parseTooltipOptions(t);var n=new google.maps.InfoWindow({content:t.text});return t.visible&&n.open(this._map,e),n}},_destroyMarker:function(e){e.marker.setMap(null),e.listener&&google.maps.event.removeListener(e.listener)},_renderRoute:function(e){return Promise.all((0,h.Tj)(e.locations,function(t){return this._resolveLocation(t)}.bind(this))).then(function(t){return new Promise(function(n){var d={origin:t.shift(),destination:t.pop(),waypoints:(0,h.Tj)(t,function(u){return{location:u,stopover:!0}}),optimizeWaypoints:!0,travelMode:this._movementMode(e.mode)};(new google.maps.DirectionsService).route(d,function(u,l){if(l===google.maps.DirectionsStatus.OK){var g=new x.A(e.color||this._defaultRouteColor()).toHex(),ve={directions:u,map:this._map,suppressMarkers:!0,preserveViewport:!0,polylineOptions:{strokeWeight:e.weight||this._defaultRouteWeight(),strokeOpacity:e.opacity||this._defaultRouteOpacity(),strokeColor:g}},Me=new google.maps.DirectionsRenderer(ve),F=u.routes[0].bounds;n({instance:Me,northEast:F.getNorthEast(),southWest:F.getSouthWest()})}else f.A.log("W1006",l),n({instance:new google.maps.DirectionsRenderer({})})}.bind(this))}.bind(this))}.bind(this))},_destroyRoute:function(e){e.instance.setMap(null)},_fitBounds:function(){if(this._updateBounds(),this._bounds&&this._option("autoAdjust")){var e=this._map.getZoom();this._preventZoomChangeEvent=!0,this._map.fitBounds(this._bounds),this._boundsChangeHandler();var t=this._map.getZoom();e<t?this._map.setZoom(e):this._option("zoom",t),delete this._preventZoomChangeEvent}return Promise.resolve()},_extendBounds:function(e){this._bounds||(this._bounds=new google.maps.LatLngBounds),this._bounds.extend(e)},clean:function(){return this._map&&(google.maps.event.removeListener(this._boundsChangeListener),google.maps.event.removeListener(this._clickListener),this._clearMarkers(),this._clearRoutes(),delete this._map,this._$container.empty()),Promise.resolve()}});var P,k=(0,W.zk)(),O="_bingScriptReady",de="https://www.bing.com/api/maps/mapcontrol?callback="+O,j=function(){return k.Microsoft&&k.Microsoft.Maps},le={googleStatic:ne,google:he,bing:$.inherit({_mapType:function(e){var t={roadmap:Microsoft.Maps.MapTypeId.road,hybrid:Microsoft.Maps.MapTypeId.aerial,satellite:Microsoft.Maps.MapTypeId.aerial};return t[e]||t.road},_movementMode:function(e){var t={driving:Microsoft.Maps.Directions.RouteMode.driving,walking:Microsoft.Maps.Directions.RouteMode.walking};return t[e]||t.driving},_resolveLocation:function(e){return new Promise(function(t){var n=this._getLatLng(e);n?t(new Microsoft.Maps.Location(n.lat,n.lng)):this._geocodeLocation(e).then(function(i){t(i)})}.bind(this))},_geocodedLocations:{},_geocodeLocationImpl:function(e){return new Promise(function(t){(0,v.O9)(e)?new Microsoft.Maps.Search.SearchManager(this._map).geocode({where:e,count:1,callback:function(o){if(o.results[0]){var d=o.results[0].location;t(new Microsoft.Maps.Location(d.latitude,d.longitude))}else t(new Microsoft.Maps.Location(0,0))}}):t(new Microsoft.Maps.Location(0,0))}.bind(this))},_normalizeLocation:function(e){return{lat:e.latitude,lng:e.longitude}},_normalizeLocationRect:function(e){var t=this._normalizeLocation(e.getNorthwest()),n=this._normalizeLocation(e.getSoutheast());return{northEast:{lat:t.lat,lng:n.lng},southWest:{lat:n.lat,lng:t.lng}}},_loadImpl:function(){return new Promise(function(e){j()?e():(P||(P=this._loadMapScript()),P.then(function(){j()?e():this._loadMapScript().then(e)}.bind(this)))}.bind(this)).then(function(){return Promise.all([new Promise(function(e){Microsoft.Maps.loadModule("Microsoft.Maps.Search",{callback:e})}),new Promise(function(e){Microsoft.Maps.loadModule("Microsoft.Maps.Directions",{callback:e})})])})},_loadMapScript:function(){return new Promise(function(e){k[O]=e,N.A.sendRequest({url:de,dataType:"script"})}).then(function(){try{delete k[O]}catch{k[O]=void 0}})},_init:function(){return this._createMap(),Promise.resolve()},_createMap:function(){var e=this._option("controls");this._map=new Microsoft.Maps.Map(this._$container[0],{credentials:this._keyOption("bing"),zoom:this._option("zoom"),showDashboard:e,showMapTypeSelector:e,showScalebar:e})},_attachHandlers:function(){this._providerViewChangeHandler=Microsoft.Maps.Events.addHandler(this._map,"viewchange",this._viewChangeHandler.bind(this)),this._providerClickHandler=Microsoft.Maps.Events.addHandler(this._map,"click",this._clickActionHandler.bind(this))},_viewChangeHandler:function(){var e=this._map.getBounds();this._option("bounds",this._normalizeLocationRect(e));var t=this._map.getCenter();this._option("center",this._normalizeLocation(t)),this._preventZoomChangeEvent||this._option("zoom",this._map.getZoom())},_clickActionHandler:function(e){"map"===e.targetType&&this._fireClickAction({location:this._normalizeLocation(e.location)})},updateDimensions:function(){var e=this._$container;return this._map.setOptions({width:(0,R.RG)(e),height:(0,R.Oq)(e)}),Promise.resolve()},updateMapType:function(){var e=this._option("type"),t=Microsoft.Maps.LabelOverlay;return this._map.setView({animate:!1,mapTypeId:this._mapType(e),labelOverlay:"satellite"===e?t.hidden:t.visible}),Promise.resolve()},updateBounds:function(){return Promise.all([this._resolveLocation(this._option("bounds.northEast")),this._resolveLocation(this._option("bounds.southWest"))]).then(function(e){var t=new Microsoft.Maps.LocationRect.fromLocations(e[0],e[1]);this._map.setView({animate:!1,bounds:t})}.bind(this))},updateCenter:function(){return this._resolveLocation(this._option("center")).then(function(e){this._map.setView({animate:!1,center:e})}.bind(this))},updateZoom:function(){return this._map.setView({animate:!1,zoom:this._option("zoom")}),Promise.resolve()},updateControls:function(){return this.clean(),this.render.apply(this,arguments)},_renderMarker:function(e){return this._resolveLocation(e.location).then(function(t){var n={icon:e.iconSrc||this._option("markerIconSrc")};if(e.html){(0,C.X)(n,{htmlContent:e.html,width:null,height:null});var i=e.htmlOffset;i&&(n.anchor=new Microsoft.Maps.Point(-i.left,-i.top))}var o=new Microsoft.Maps.Pushpin(t,n);this._map.entities.push(o);var d,r=this._renderTooltip(t,e.tooltip);if(e.onClick||e.tooltip){var u=this._mapWidget._createAction(e.onClick||H.lQ),l=this._normalizeLocation(t);d=Microsoft.Maps.Events.addHandler(o,"click",function(){u({location:l}),r&&r.setOptions({visible:!0})})}return{location:t,marker:o,infobox:r,handler:d}}.bind(this))},_renderTooltip:function(e,t){if(t){t=this._parseTooltipOptions(t);var n=new Microsoft.Maps.Infobox(e,{description:t.text,offset:new Microsoft.Maps.Point(0,13),visible:t.visible});return n.setMap(this._map),n}},_destroyMarker:function(e){this._map.entities.remove(e.marker),e.infobox&&e.infobox.setMap(null),e.handler&&Microsoft.Maps.Events.removeHandler(e.handler)},_renderRoute:function(e){return Promise.all((0,h.Tj)(e.locations,function(t){return this._resolveLocation(t)}.bind(this))).then(function(t){return new Promise(function(n){var i=new Microsoft.Maps.Directions.DirectionsManager(this._map),o=new x.A(e.color||this._defaultRouteColor()).toHex(),r=new Microsoft.Maps.Color.fromHex(o);r.a=255*(e.opacity||this._defaultRouteOpacity()),i.setRenderOptions({autoUpdateMapView:!1,displayRouteSelector:!1,waypointPushpinOptions:{visible:!1},drivingPolylineOptions:{strokeColor:r,strokeThickness:e.weight||this._defaultRouteWeight()},walkingPolylineOptions:{strokeColor:r,strokeThickness:e.weight||this._defaultRouteWeight()}}),i.setRequestOptions({routeMode:this._movementMode(e.mode),routeDraggable:!1}),(0,h.__)(t,function(u,l){var g=new Microsoft.Maps.Directions.Waypoint({location:l});i.addWaypoint(g)});var d=[];d.push(Microsoft.Maps.Events.addHandler(i,"directionsUpdated",function(u){for(;d.length;)Microsoft.Maps.Events.removeHandler(d.pop());var l=u.routeSummary[0];n({instance:i,northEast:l.northEast,southWest:l.southWest})})),d.push(Microsoft.Maps.Events.addHandler(i,"directionsError",function(u){for(;d.length;)Microsoft.Maps.Events.removeHandler(d.pop());f.A.log("W1006","RouteResponseCode: "+u.responseCode+" - "+u.message),n({instance:i})})),i.calculateDirections()}.bind(this))}.bind(this))},_destroyRoute:function(e){e.instance.dispose()},_fitBounds:function(){if(this._updateBounds(),this._bounds&&this._option("autoAdjust")){var e=this._map.getZoom();this._preventZoomChangeEvent=!0;var t=this._bounds.clone();t.height=1.1*t.height,t.width=1.1*t.width,this._map.setView({animate:!1,bounds:t,zoom:e});var n=this._map.getZoom();e<n?this._map.setView({animate:!1,zoom:e}):this._option("zoom",n),delete this._preventZoomChangeEvent}return Promise.resolve()},_extendBounds:function(e){this._bounds=this._bounds?new Microsoft.Maps.LocationRect.fromLocations(this._bounds.getNorthwest(),this._bounds.getSoutheast(),e):new Microsoft.Maps.LocationRect(e,1e-16,1e-16)},clean:function(){return this._map&&(Microsoft.Maps.Events.removeHandler(this._providerViewChangeHandler),Microsoft.Maps.Events.removeHandler(this._providerClickHandler),this._clearMarkers(),this._clearRoutes(),this._map.dispose()),Promise.resolve()}})},V="dx-map-shield",Z=Q.A.inherit({_getDefaultOptions:function(){return(0,C.X)(this.callBase(),{bounds:{northEast:null,southWest:null},center:{lat:0,lng:0},zoom:1,width:300,height:300,type:"roadmap",provider:"google",autoAdjust:!0,markers:[],markerIconSrc:null,onMarkerAdded:null,onMarkerRemoved:null,routes:[],onRouteAdded:null,onRouteRemoved:null,apiKey:{bing:"",google:"",googleStatic:""},controls:!1,onReady:null,onUpdated:null,onClick:null})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===L.A.real().deviceType&&!L.A.isSimulator()},options:{focusStateEnabled:!0}}])},_init:function(){this.callBase(),this.$element().addClass("dx-map"),this._lastAsyncAction=Promise.resolve(),this._checkOption("provider"),this._checkOption("markers"),this._checkOption("routes"),this._initContainer(),this._grabEvents(),this._rendered={}},_useTemplates:function(){return!1},_checkOption:function(e){var t=this.option(e);if("markers"===e&&!Array.isArray(t))throw f.A.Error("E1022");if("routes"===e&&!Array.isArray(t))throw f.A.Error("E1023")},_initContainer:function(){this._$container=(0,y.A)("<div>").addClass("dx-map-container"),this.$element().append(this._$container)},_grabEvents:function(){var e=(0,D.b4)(Y.A.down,this.NAME);A.A.on(this.$element(),e,this._cancelEvent.bind(this))},_cancelEvent:function(e){this._provider&&this._provider.isEventsCanceled(e)&&!this.option("disabled")&&e.stopPropagation()},_saveRendered:function(e){var t=this.option(e);this._rendered[e]=t.slice()},_render:function(){this.callBase(),this._renderShield(),this._saveRendered("markers"),this._saveRendered("routes"),this._provider=new(le[this.option("provider")])(this,this._$container),this._queueAsyncAction("render",this._rendered.markers,this._rendered.routes)},_renderShield:function(){var e;this.option("disabled")?(e=(0,y.A)("<div>").addClass(V),this.$element().append(e)):(e=this.$element().find("."+V)).remove()},_clean:function(){this._cleanFocusState(),this._provider&&this._provider.clean(),this._provider=null,this._lastAsyncAction=Promise.resolve(),this.setOptionSilent("bounds",{northEast:null,southWest:null}),delete this._suppressAsyncAction},_optionChanged:function(e){var t=e.name,n=this._optionChangeBag;switch(this._optionChangeBag=null,t){case"disabled":this._renderShield(),this.callBase(e);break;case"width":case"height":this.callBase(e),this._dimensionChanged();break;case"provider":this._suppressAsyncAction=!0,this._invalidate();break;case"apiKey":f.A.log("W1001");break;case"bounds":this._queueAsyncAction("updateBounds");break;case"center":this._queueAsyncAction("updateCenter");break;case"zoom":this._queueAsyncAction("updateZoom");break;case"type":this._queueAsyncAction("updateMapType");break;case"controls":this._queueAsyncAction("updateControls",this._rendered.markers,this._rendered.routes);break;case"autoAdjust":this._queueAsyncAction("adjustViewport");break;case"markers":case"routes":this._checkOption(t);var i=this._rendered[t];this._saveRendered(t),this._queueAsyncAction("update"+(0,T.Ns)(t),n?n.removed:i,n?n.added:this._rendered[t]).then(function(o){n&&n.resolve(o)});break;case"markerIconSrc":this._queueAsyncAction("updateMarkers",this._rendered.markers,this._rendered.markers);break;case"onReady":case"onUpdated":case"onMarkerAdded":case"onMarkerRemoved":case"onRouteAdded":case"onRouteRemoved":case"onClick":break;default:this.callBase.apply(this,arguments)}},_visibilityChanged:function(e){e&&this._dimensionChanged()},_dimensionChanged:function(){this._queueAsyncAction("updateDimensions")},_queueAsyncAction:function(e){var t=[].slice.call(arguments).slice(1),n=this._suppressAsyncAction;return this._lastAsyncAction=this._lastAsyncAction.then(function(){return!this._provider||n?Promise.resolve():this._provider[e].apply(this._provider,t).then(function(i){return(i=(0,S.BO)(i))[0]&&!this._disposed&&this._triggerReadyAction(),i[1]}.bind(this))}.bind(this)),this._lastAsyncAction},_triggerReadyAction:function(){this._createActionByOption("onReady")({originalMap:this._provider.map()})},_triggerUpdateAction:function(){this._createActionByOption("onUpdated")()},setOptionSilent:function(e,t){this._setOptionWithoutOptionChange(e,t)},addMarker:function(e){return this._addFunction("markers",e)},removeMarker:function(e){return this._removeFunction("markers",e)},addRoute:function(e){return this._addFunction("routes",e)},removeRoute:function(e){return this._removeFunction("routes",e)},_addFunction:function(e,t){var n=this.option(e),i=(0,S.BO)(t);return n.push.apply(n,i),this._partialArrayOptionChange(e,n,i,[])},_removeFunction:function(e,t){var n=this.option(e),i=(0,S.BO)(t);return(0,h.__)(i,function(o,r){var d=(0,v.kf)(r)?r:n?.indexOf(r);if(-1===d)throw f.A.log("E1021",(0,T.Ns)(e.substring(0,e.length-1)),r);var u=n.splice(d,1)[0];i.splice(o,1,u)}),this._partialArrayOptionChange(e,n,[],i)},_partialArrayOptionChange:function(e,t,n,i){return(0,X.Sx)(new Promise(function(o){this._optionChangeBag={resolve:o,added:n,removed:i},this.option(e,t)}.bind(this)).then(function(o){return o&&1===o.length?o[0]:o}),this)}});(0,J.A)("dxMap",Z);var _=s(27380),c=s(31837);s(345);let ge=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=a.$C({type:e}),e.\u0275inj=a.G2t({imports:[[c.B6P,c.Hh_,c.Who,c.Dgy,c.Vku,c.Naz,_.p_,_.xZ],c.B6P,c.Hh_,c.Who,c.Dgy,c.Vku,c.Naz,_.xZ]}),e})()}}]);