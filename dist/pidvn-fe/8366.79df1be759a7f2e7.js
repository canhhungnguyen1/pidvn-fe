"use strict";(self.webpackChunkpidvn_fe=self.webpackChunkpidvn_fe||[]).push([[8366],{8366:(K,D,o)=>{o.r(D),o.d(D,{IeModule:()=>Z});var g=o(60177),n=o(89417),B=o(53281),v=o(72915),U=o(33514),x=o(12673),e=o(54438),p=(o(98508),o(27380)),m=o(31837);o(345);let P=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[[m.POb,p.p_,p.xZ],m.POb,p.xZ]}),i})();var _=o(50513),y=o(74696),O=o(97529),G=o(21011),N=o(43053),I=o(1997),f=o(23359),A=o(9541),b=o(46661);let F=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-ie"]],decls:1,vars:0,template:function(s,d){1&s&&e.nrm(0,"router-outlet")},dependencies:[b.n3],encapsulation:2})}return i})();var R=o(45312),w=o(21626);let a=(()=>{class i{constructor(t){this.httpClient=t,this.baseUrl=R.c.baseUrl}getMachines(){return this.httpClient.get(`${this.baseUrl}/IE/Machine/Machines`)}getMachinesFiles(){return this.httpClient.get(`${this.baseUrl}/IE/Machine/Files`)}uploadFile(t,s){const d=new FormData;t.forEach(C=>{d.append("files",C,C.name)});const c=new Blob([JSON.stringify(s)],{type:"application/json"});return d.append("fileInfo",c),this.httpClient.post(`${this.baseUrl}/IE/Machine/File`,d)}downloadFile(t){return this.httpClient.post(`${this.baseUrl}/IE/Machine/DownloadFile`,t,{responseType:"blob"})}static#e=this.\u0275fac=function(s){return new(s||i)(e.KVO(w.Qq))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var E=o(45794),l=o(37736),r=o(16389),h=o(25930);const z=["fileUploader"],H=()=>[""],j=()=>({"aria-label":"Select file"}),X=()=>[10,25,50,100];function L(i,u){if(1&i&&e.nrm(0,"nz-option",24),2&i){const t=u.$implicit;e.Y8G("nzLabel","("+t.code+") - "+t.name)("nzValue",t.code)}}function V(i,u){if(1&i){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const d=e.XpG();return e.Njj(d.uploadFile())}),e.EFF(1," Upload "),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("nzLoading",t.isLoading)}}function Y(i,u){if(1&i){const t=e.RV6();e.j41(0,"button",26),e.bIt("click",function(){e.eBV(t);const d=e.XpG();return e.Njj(d.clearFiles())}),e.EFF(1," X\xf3a c\xe1c file \u0111\xe3 ch\u1ecdn "),e.k0s()}}function k(i,u){if(1&i){const t=e.RV6();e.j41(0,"div",27)(1,"a",28),e.bIt("click",function(){const d=e.eBV(t).$implicit,c=e.XpG();return e.Njj(c.downloadFile(d))}),e.EFF(2,"T\u1ea3i xu\u1ed1ng"),e.k0s()()}}const W=[{path:"",component:F,children:[{path:"drawing-control",loadChildren:()=>Promise.all([o.e(5154),o.e(7064),o.e(1789),o.e(5960),o.e(5703),o.e(4042),o.e(9462),o.e(6220),o.e(2076),o.e(3767)]).then(o.bind(o,23767)).then(i=>i.DrawingControlModule)},{path:"machine-document",component:(()=>{class i{constructor(t,s,d,c){this.ieMaDoSvc=t,this.activatedRoute=s,this.toastr=d,this.jwtHelperSvc=c,this.isOpenUploadModal=!1,this.machineCode=null,this.isLoading=!1}ngOnInit(){this.getMachines(),this.getMachineFiles()}getMachineFiles(){this.machineFileGrid?.instance.beginCustomLoading("\u0110ang t\u1ea3i d\u1eef li\u1ec7u ..."),this.ieMaDoSvc.getMachinesFiles().subscribe(t=>{this.machineFiles=t.result,this.machineFileGrid.instance.endCustomLoading()})}getMachines(){this.ieMaDoSvc.getMachines().subscribe(t=>{this.machines=t.result})}uploadFile(){if(null==this.machineCode)return void this.toastr.warning("M\xe1y kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng","Warning");this.isLoading=!0;const t=this.fileUploader;console.log("uploadFile: ",t.value[0]);let s=this.jwtHelperSvc.decodeToken(localStorage.getItem("accessToken")?.toString()).Username;this.ieMaDoSvc.uploadFile(t.value,{machineCode:this.machineCode,createdBy:s}).subscribe(c=>{this.toastr.success("Upload th\xe0nh c\xf4ng","Success"),console.log("response: ",c),this.getMachineFiles(),this.isLoading=!1,this.clearFiles()})}clearFiles(){this.fileUploader.instance.reset(),this.machineCode=null}downloadFile(t){this.ieMaDoSvc.downloadFile(t.data).subscribe(s=>{console.log(s);const d=new Blob([s],{}),c=window.URL.createObjectURL(d),C=document.createElement("a");C.href=c,C.download=`${t.data.name}`,C.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(()=>{window.URL.revokeObjectURL(c),C.remove()},100)})}static#e=this.\u0275fac=function(s){return new(s||i)(e.rXU(a),e.rXU(b.nX),e.rXU(E.tw),e.rXU(l.X7))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-ie-ma-do"]],viewQuery:function(s,d){if(1&s&&(e.GBs(x.s,5),e.GBs(z,5)),2&s){let c;e.mGM(c=e.lsd())&&(d.machineFileGrid=c.first),e.mGM(c=e.lsd())&&(d.fileUploader=c.first)}},decls:43,vars:28,consts:[["fileUploader",""],["machineFileGrid",""],["nz-row","","nzJustify","start","nzAlign","top",3,"nzGutter"],["nz-col","","nzXs","8"],["nzActive","true",3,"nzHeader"],["nzSize","small","nzBordered","","nzFrontPagination","false",1,"project-activity",3,"nzData"],["nzShowSearch","true","nzAllowClear","true",2,"width","100%",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["selectButtonText","Ch\u1ecdn file","labelText","","accept","image/*, .pdf, .doc, .docx, .ppt, .pptx, .xls, .xlsx","uploadMode","useForm",3,"multiple","inputAttr"],["nz-button","","nzType","primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","default",3,"click",4,"ngIf"],["nz-col","","nzXs","16"],["keyExpr","id",3,"dataSource","showColumnLines","showRowLines","showBorders","allowColumnResizing","columnAutoWidth","rowAlternationEnabled"],[3,"visible"],["dataField","name","caption","File Name"],["dataField","machineCode","caption","Machine Code",3,"groupIndex"],["dataField","machineName","caption","Machine Name"],["dataField","createdByName","caption","Ng\u01b0\u1eddi upload"],["alignment","center","dataField","createdAt","caption","Time","dataType","date","format","yyyy-MM-dd HH:mm"],["caption","Action","cellTemplate","actionTemplate","fixedPosition","right",3,"fixed"],["style","text-align: center",4,"dxTemplate","dxTemplateOf"],["column","machineCode","summaryType","count","displayFormat","{0} files","groupIndex","0"],[3,"pageSize"],[3,"showPageSizeSelector","allowedPageSizes"],[3,"nzLabel","nzValue"],["nz-button","","nzType","primary",3,"click","nzLoading"],["nz-button","","nzType","default",3,"click"],[2,"text-align","center"],[3,"click"]],template:function(s,d){if(1&s){const c=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"nz-collapse")(3,"nz-collapse-panel",4)(4,"nz-table",5)(5,"tbody")(6,"tr")(7,"td")(8,"label"),e.EFF(9,"M\xe1y"),e.k0s()(),e.j41(10,"td")(11,"nz-select",6),e.mxI("ngModelChange",function(M){return e.eBV(c),e.DH7(d.machineCode,M)||(d.machineCode=M),e.Njj(M)}),e.DNE(12,L,1,2,"nz-option",7),e.k0s()()(),e.j41(13,"tr")(14,"td")(15,"label"),e.EFF(16,"File"),e.k0s()(),e.j41(17,"td"),e.nrm(18,"dx-file-uploader",8,0),e.k0s()(),e.j41(20,"tr"),e.nrm(21,"td"),e.j41(22,"td"),e.DNE(23,V,2,1,"button",9)(24,Y,2,0,"button",10),e.k0s()()()()()()(),e.j41(25,"div",11)(26,"nz-collapse")(27,"nz-collapse-panel",4)(28,"dx-data-grid",12,1),e.nrm(30,"dxo-header-filter",13)(31,"dxo-filter-row",13)(32,"dxi-column",14)(33,"dxi-column",15)(34,"dxi-column",16)(35,"dxi-column",17)(36,"dxi-column",18)(37,"dxi-column",19),e.DNE(38,k,3,0,"div",20),e.j41(39,"dxo-summary"),e.nrm(40,"dxi-group-item",21),e.k0s(),e.nrm(41,"dxo-paging",22)(42,"dxo-pager",23),e.k0s()()()()()}if(2&s){const c=e.sdS(19);e.Y8G("nzGutter",24),e.R7$(3),e.Y8G("nzHeader","Upload"),e.R7$(),e.Y8G("nzData",e.lJ4(25,H)),e.R7$(7),e.R50("ngModel",d.machineCode),e.R7$(),e.Y8G("ngForOf",d.machines),e.R7$(6),e.Y8G("multiple",!0)("inputAttr",e.lJ4(26,j)),e.R7$(5),e.Y8G("ngIf",c.value.length),e.R7$(),e.Y8G("ngIf",c.value.length),e.R7$(3),e.Y8G("nzHeader","Danh s\xe1ch file"),e.R7$(),e.Y8G("dataSource",d.machineFiles)("showColumnLines",!0)("showRowLines",!0)("showBorders",!0)("allowColumnResizing",!0)("columnAutoWidth",!0)("rowAlternationEnabled",!0),e.R7$(2),e.Y8G("visible",!0),e.R7$(),e.Y8G("visible",!0),e.R7$(2),e.Y8G("groupIndex",0),e.R7$(4),e.Y8G("fixed",!0),e.R7$(),e.Y8G("dxTemplateOf","actionTemplate"),e.R7$(3),e.Y8G("pageSize",10),e.R7$(),e.Y8G("showPageSizeSelector",!0)("allowedPageSizes",e.lJ4(27,X))}},dependencies:[g.Sq,g.bT,n.BC,n.vS,p.eC,v.m,f.CP,f.SO,f.aj,f.kt,_.aO,r.c,h.p,I.ld,I.WI,y.Vz,y.pc,O.Uq,O.e,x.s,m.nj_,m.gtJ,m.FTx,m.sVQ,m.PVd,m.XvM,m.ryC]})}return i})()}]}];let J=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[b.iI.forChild(W),b.iI]})}return i})();var Q=o(72544);let Z=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[g.MD,n.YN,J,P,A.hM,B.Z,v.b,U.L,f.$G,N.U6,_.Zw,G.j,I.DH,y.GB,O.f3,x.N,Q.Y3]})}return i})()},74696:(K,D,o)=>{o.d(D,{GB:()=>w,Vz:()=>R,pc:()=>b});var g=o(15215),n=o(54438),B=o(73586),v=o(7605),U=o(58728),x=o(40713),e=o(16042),T=o(57806),p=o(21025),m=o(70317),S=o(72544),$=o(28203),P=o(26841);const _=["*"],y=["collapseHeader"];function O(a,E){if(1&a&&(n.qex(0),n.nrm(1,"span",7),n.bVm()),2&a){const l=E.$implicit,r=n.XpG(2);n.R7$(),n.Y8G("nzType",l||"right")("nzRotate",r.nzActive?90:0)}}function G(a,E){if(1&a&&(n.j41(0,"div"),n.DNE(1,O,2,2,"ng-container",3),n.k0s()),2&a){const l=n.XpG();n.R7$(),n.Y8G("nzStringTemplateOutlet",l.nzExpandedIcon)}}function N(a,E){if(1&a&&(n.qex(0),n.EFF(1),n.bVm()),2&a){const l=n.XpG();n.R7$(),n.JRh(l.nzHeader)}}function I(a,E){if(1&a&&(n.qex(0),n.EFF(1),n.bVm()),2&a){const l=n.XpG(2);n.R7$(),n.JRh(l.nzExtra)}}function f(a,E){if(1&a&&(n.j41(0,"div",4),n.DNE(1,I,2,1,"ng-container",3),n.k0s()),2&a){const l=n.XpG();n.R7$(),n.Y8G("nzStringTemplateOutlet",l.nzExtra)}}const A="collapse";let b=(()=>{class a{constructor(l,r,h,z){this.nzConfigService=l,this.cdr=r,this.directionality=h,this.destroy$=z,this._nzModuleName=A,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(A).pipe((0,v.Q)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,v.Q)(this.destroy$)).subscribe(l=>{this.dir=l,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(l){this.listOfNzCollapsePanelComponent.push(l)}removePanel(l){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(l),1)}click(l){this.nzAccordion&&!l.nzActive&&this.listOfNzCollapsePanelComponent.filter(r=>r!==l).forEach(r=>{r.nzActive&&(r.nzActive=!1,r.nzActiveChange.emit(r.nzActive),r.markForCheck())}),l.nzActive=!l.nzActive,l.nzActiveChange.emit(l.nzActive)}static#e=this.\u0275fac=function(r){return new(r||a)(n.rXU(e.yx),n.rXU(n.gRc),n.rXU($.dS,8),n.rXU(p.y4))};static#t=this.\u0275cmp=n.VBU({type:a,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(r,h){2&r&&n.AVh("ant-collapse-icon-position-start","left"===h.nzExpandIconPosition)("ant-collapse-icon-position-end","right"===h.nzExpandIconPosition)("ant-collapse-ghost",h.nzGhost)("ant-collapse-borderless",!h.nzBordered)("ant-collapse-rtl","rtl"===h.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],standalone:!0,features:[n.Jv_([p.y4]),n.aNF],ngContentSelectors:_,decls:1,vars:0,template:function(r,h){1&r&&(n.NAR(),n.SdG(0))},encapsulation:2,changeDetection:0})}return(0,g.Cg)([(0,e.H4)(),(0,m.H3)()],a.prototype,"nzAccordion",void 0),(0,g.Cg)([(0,e.H4)(),(0,m.H3)()],a.prototype,"nzBordered",void 0),(0,g.Cg)([(0,e.H4)(),(0,m.H3)()],a.prototype,"nzGhost",void 0),a})();const F="collapsePanel";let R=(()=>{class a{markForCheck(){this.cdr.markForCheck()}constructor(l,r,h,z,H,j){this.nzConfigService=l,this.ngZone=r,this.cdr=h,this.destroy$=z,this.nzCollapseComponent=H,this.noAnimation=j,this._nzModuleName=F,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new n.bkB,this.nzConfigService.getConfigChangeEventForComponent(F).pipe((0,v.Q)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>(0,B.R)(this.collapseHeader.nativeElement,"click").pipe((0,U.p)(()=>!this.nzDisabled),(0,v.Q)(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}static#e=this.\u0275fac=function(r){return new(r||a)(n.rXU(e.yx),n.rXU(n.SKi),n.rXU(n.gRc),n.rXU(p.y4),n.rXU(b,1),n.rXU(P.z,8))};static#t=this.\u0275cmp=n.VBU({type:a,selectors:[["nz-collapse-panel"]],viewQuery:function(r,h){if(1&r&&n.GBs(y,7),2&r){let z;n.mGM(z=n.lsd())&&(h.collapseHeader=z.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(r,h){2&r&&n.AVh("ant-collapse-no-arrow",!h.nzShowArrow)("ant-collapse-item-active",h.nzActive)("ant-collapse-item-disabled",h.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],standalone:!0,features:[n.Jv_([p.y4]),n.aNF],ngContentSelectors:_,decls:9,vars:8,consts:[["collapseHeader",""],["role","button",1,"ant-collapse-header"],[1,"ant-collapse-header-text"],[4,"nzStringTemplateOutlet"],[1,"ant-collapse-extra"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"]],template:function(r,h){1&r&&(n.NAR(),n.j41(0,"div",1,0),n.DNE(2,G,2,1,"div"),n.j41(3,"span",2),n.DNE(4,N,2,1,"ng-container",3),n.k0s(),n.DNE(5,f,2,1,"div",4),n.k0s(),n.j41(6,"div",5)(7,"div",6),n.SdG(8),n.k0s()()),2&r&&(n.BMQ("aria-expanded",h.nzActive),n.R7$(2),n.vxM(2,h.nzShowArrow?2:-1),n.R7$(2),n.Y8G("nzStringTemplateOutlet",h.nzHeader),n.R7$(),n.vxM(5,h.nzExtra?5:-1),n.R7$(),n.AVh("ant-collapse-content-active",h.nzActive),n.Y8G("@.disabled",!(null==h.noAnimation||!h.noAnimation.nzNoAnimation))("@collapseMotion",h.nzActive?"expanded":"hidden"))},dependencies:[T.C,T.m,S.Y3,S.Dn],encapsulation:2,data:{animation:[x.GE]},changeDetection:0})}return(0,g.Cg)([(0,m.H3)()],a.prototype,"nzActive",void 0),(0,g.Cg)([(0,m.H3)()],a.prototype,"nzDisabled",void 0),(0,g.Cg)([(0,e.H4)(),(0,m.H3)()],a.prototype,"nzShowArrow",void 0),a})(),w=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275mod=n.$C({type:a});static#n=this.\u0275inj=n.G2t({imports:[R]})}return a})()}}]);