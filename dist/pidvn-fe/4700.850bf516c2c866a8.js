"use strict";(self.webpackChunkpidvn_fe=self.webpackChunkpidvn_fe||[]).push([[4700],{34700:(N,E,s)=>{s.r(E),s.d(E,{VrDefectRecordModule:()=>L});var O=s(60177),v=s(12673),_=s(87018),e=s(54438),D=s(89454),p=s(89417),h=s(27380),z=s(345);const M={provide:p.kq,useExisting:(0,e.Rfq)(()=>x),multi:!0};let x=(()=>{class i extends h.ic{constructor(t,n,a,o,c,d,r,l){super(t,n,a,o,r,l),this._watcherHelper=o,this._idh=c,this.touched=K=>{},this._createEventEmitters([{subscribe:"contentReady",emit:"onContentReady"},{subscribe:"disposing",emit:"onDisposing"},{subscribe:"initialized",emit:"onInitialized"},{subscribe:"optionChanged",emit:"onOptionChanged"},{subscribe:"valueChanged",emit:"onValueChanged"},{emit:"accessKeyChange"},{emit:"activeStateEnabledChange"},{emit:"disabledChange"},{emit:"elementAttrChange"},{emit:"enableThreeStateBehaviorChange"},{emit:"focusStateEnabledChange"},{emit:"heightChange"},{emit:"hintChange"},{emit:"hoverStateEnabledChange"},{emit:"iconSizeChange"},{emit:"isValidChange"},{emit:"nameChange"},{emit:"readOnlyChange"},{emit:"rtlEnabledChange"},{emit:"tabIndexChange"},{emit:"textChange"},{emit:"validationErrorChange"},{emit:"validationErrorsChange"},{emit:"validationMessageModeChange"},{emit:"validationMessagePositionChange"},{emit:"validationStatusChange"},{emit:"valueChange"},{emit:"visibleChange"},{emit:"widthChange"},{emit:"onBlur"}]),this._idh.setHost(this),d.setHost(this)}get accessKey(){return this._getOption("accessKey")}set accessKey(t){this._setOption("accessKey",t)}get activeStateEnabled(){return this._getOption("activeStateEnabled")}set activeStateEnabled(t){this._setOption("activeStateEnabled",t)}get disabled(){return this._getOption("disabled")}set disabled(t){this._setOption("disabled",t)}get elementAttr(){return this._getOption("elementAttr")}set elementAttr(t){this._setOption("elementAttr",t)}get enableThreeStateBehavior(){return this._getOption("enableThreeStateBehavior")}set enableThreeStateBehavior(t){this._setOption("enableThreeStateBehavior",t)}get focusStateEnabled(){return this._getOption("focusStateEnabled")}set focusStateEnabled(t){this._setOption("focusStateEnabled",t)}get height(){return this._getOption("height")}set height(t){this._setOption("height",t)}get hint(){return this._getOption("hint")}set hint(t){this._setOption("hint",t)}get hoverStateEnabled(){return this._getOption("hoverStateEnabled")}set hoverStateEnabled(t){this._setOption("hoverStateEnabled",t)}get iconSize(){return this._getOption("iconSize")}set iconSize(t){this._setOption("iconSize",t)}get isValid(){return this._getOption("isValid")}set isValid(t){this._setOption("isValid",t)}get name(){return this._getOption("name")}set name(t){this._setOption("name",t)}get readOnly(){return this._getOption("readOnly")}set readOnly(t){this._setOption("readOnly",t)}get rtlEnabled(){return this._getOption("rtlEnabled")}set rtlEnabled(t){this._setOption("rtlEnabled",t)}get tabIndex(){return this._getOption("tabIndex")}set tabIndex(t){this._setOption("tabIndex",t)}get text(){return this._getOption("text")}set text(t){this._setOption("text",t)}get validationError(){return this._getOption("validationError")}set validationError(t){this._setOption("validationError",t)}get validationErrors(){return this._getOption("validationErrors")}set validationErrors(t){this._setOption("validationErrors",t)}get validationMessageMode(){return this._getOption("validationMessageMode")}set validationMessageMode(t){this._setOption("validationMessageMode",t)}get validationMessagePosition(){return this._getOption("validationMessagePosition")}set validationMessagePosition(t){this._setOption("validationMessagePosition",t)}get validationStatus(){return this._getOption("validationStatus")}set validationStatus(t){this._setOption("validationStatus",t)}get value(){return this._getOption("value")}set value(t){this._setOption("value",t)}get visible(){return this._getOption("visible")}set visible(t){this._setOption("visible",t)}get width(){return this._getOption("width")}set width(t){this._setOption("width",t)}change(t){}_createInstance(t,n){return new D.A(t,n)}writeValue(t){this.eventHelper.lockedValueChangeEvent=!0,this.value=t,this.eventHelper.lockedValueChangeEvent=!1}setDisabledState(t){this.disabled=t}registerOnChange(t){this.change=t}registerOnTouched(t){this.touched=t}_createWidget(t){super._createWidget(t),this.instance.on("focusOut",n=>{this.eventHelper.fireNgEvent("onBlur",[n])})}ngOnDestroy(){this._destroyWidget()}ngOnChanges(t){super.ngOnChanges(t),this.setupChanges("validationErrors",t)}setupChanges(t,n){t in this._optionsToUpdate||this._idh.setup(t,n)}ngDoCheck(){this._idh.doCheck("validationErrors"),this._watcherHelper.checkWatchers(),super.ngDoCheck(),super.clearChangedOptions()}_setOption(t,n){let a=this._idh.setupSingle(t,n),o=null!==this._idh.getChanges(t,n);(a||o)&&super._setOption(t,n)}}return i.\u0275fac=function(t){return new(t||i)(e.rXU(e.aKT),e.rXU(e.SKi),e.rXU(h.zF),e.rXU(h.jS),e.rXU(h.$M),e.rXU(h.fH),e.rXU(z.pJ),e.rXU(e.Agw))},i.\u0275cmp=e.VBU({type:i,selectors:[["dx-check-box"]],hostBindings:function(t,n){1&t&&e.bIt("valueChange",function(o){return n.change(o)})("onBlur",function(o){return n.touched(o)})},inputs:{accessKey:"accessKey",activeStateEnabled:"activeStateEnabled",disabled:"disabled",elementAttr:"elementAttr",enableThreeStateBehavior:"enableThreeStateBehavior",focusStateEnabled:"focusStateEnabled",height:"height",hint:"hint",hoverStateEnabled:"hoverStateEnabled",iconSize:"iconSize",isValid:"isValid",name:"name",readOnly:"readOnly",rtlEnabled:"rtlEnabled",tabIndex:"tabIndex",text:"text",validationError:"validationError",validationErrors:"validationErrors",validationMessageMode:"validationMessageMode",validationMessagePosition:"validationMessagePosition",validationStatus:"validationStatus",value:"value",visible:"visible",width:"width"},outputs:{onContentReady:"onContentReady",onDisposing:"onDisposing",onInitialized:"onInitialized",onOptionChanged:"onOptionChanged",onValueChanged:"onValueChanged",accessKeyChange:"accessKeyChange",activeStateEnabledChange:"activeStateEnabledChange",disabledChange:"disabledChange",elementAttrChange:"elementAttrChange",enableThreeStateBehaviorChange:"enableThreeStateBehaviorChange",focusStateEnabledChange:"focusStateEnabledChange",heightChange:"heightChange",hintChange:"hintChange",hoverStateEnabledChange:"hoverStateEnabledChange",iconSizeChange:"iconSizeChange",isValidChange:"isValidChange",nameChange:"nameChange",readOnlyChange:"readOnlyChange",rtlEnabledChange:"rtlEnabledChange",tabIndexChange:"tabIndexChange",textChange:"textChange",validationErrorChange:"validationErrorChange",validationErrorsChange:"validationErrorsChange",validationMessageModeChange:"validationMessageModeChange",validationMessagePositionChange:"validationMessagePositionChange",validationStatusChange:"validationStatusChange",valueChange:"valueChange",visibleChange:"visibleChange",widthChange:"widthChange",onBlur:"onBlur"},features:[e.Jv_([h.zF,h.jS,M,h.fH,h.$M]),e.Vt3,e.OA$],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[[h.p_,h.xZ],h.xZ]}),i})();var I=s(33514),f=s(97529),R=s(21011),m=s(1997),g=s(23359),b=s(46661),V=s(10467);class B{}var j=s(45794),F=s(45312),P=s(21626);let w=(()=>{class i{constructor(t){this.httpClient=t,this.baseUrl=F.c.baseUrl}getProcessByLine(t){return this.httpClient.get(`${this.baseUrl}/VR/DefectRecord/Process?line=${t}`)}getDefectRecords(t,n){return this.httpClient.get(`${this.baseUrl}/VR/DefectRecord/DefectRecords?processId=${t}&lotNo=${n}`)}saveDefectRecords(t){return this.httpClient.post(`${this.baseUrl}/VR/DefectRecord/DefectRecords`,t)}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(P.Qq))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var k=s(37736),C=s(31837),S=s(9541);const T=["infoIpt"],A=()=>[""];function U(i,u){if(1&i&&e.nrm(0,"nz-option",23),2&i){const t=u.$implicit;e.Y8G("nzValue",t.id)("nzLabel",t.processName)}}const G=[{path:"input",component:(()=>{class i{constructor(t,n,a,o){this.toastr=t,this.activatedRoute=n,this.vrDefectRecordSvc=a,this.jwtHelperSvc=o,this.infoScan={qaCard:null,model:null,line:null,date:null,shift:null,user:null}}ngOnInit(){this.getProcess()}ngAfterViewInit(){setTimeout(()=>{this.infoIpt.nativeElement.focus(),this.scanInfo({target:{value:this.activatedRoute.snapshot.queryParams.qaCard}})},0)}getProcess(){let n=this.activatedRoute.snapshot.queryParams.qaCard.split("*")[1];this.vrDefectRecordSvc.getProcessByLine(n).subscribe(a=>{this.processes=a})}scanInfo(t){let n=t.target.value,a=n.split("*");if(5===a.length){if(n.includes(";"))return this.toastr.warning("C\u1ea7n scan QA card v\xe0 ID"),void this.infoIpt.nativeElement.select();this.infoScan.qaCard=n,this.infoScan.model=a[0],this.infoScan.line=a[1],this.infoScan.date=a[2],this.infoScan.shift=a[3]}7===n.length&&(this.infoScan.user=n),this.infoIpt.nativeElement.select()}onSaveHandler(t){var n=this;return(0,V.A)(function*(){let a=n.activatedRoute.snapshot.queryParams.qaCard,o=a.split("*"),c=new Array;yield t.changes.forEach(r=>{c.push(r.key)});let d=new Array;c.forEach(r=>{let l=new B;l.id=r.id,l.model=r.id?r.model:o[0],l.line=r.id?r.line:o[1],l.date=r.id?new Date(r.date):new Date(o[2]),l.shift=r.id?r.shift:o[3],l.lotNo=r.id?r.lotNo:a,l.defectCode=r.defectCode,l.qty=r.qty,l.remark=r.remark,l.status=r.status,l.userId=n.jwtHelperSvc.decodeToken(localStorage.getItem("accessToken")?.toString()).UserId,d.push(l)}),n.defectGrid?.instance.beginCustomLoading("Saving ..."),n.vrDefectRecordSvc.saveDefectRecords(d).subscribe(r=>{n.defectGrid.instance.endCustomLoading(),n.vrDefectRecordSvc.getDefectRecords(n.selectedProcess,a).subscribe(l=>{n.defectRecords=l,n.toastr.success("Success !","L\u01b0u th\xe0nh c\xf4ng")}),console.log("Save response: ",r)},r=>{n.defectGrid.instance.endCustomLoading(),console.log("Save error: ",r),n.toastr.error("Error !","C\xf3 l\u1ed7i")})})()}onChangeProcess(t){console.log(t),this.infoScan.user?(this.infoIpt.nativeElement.select(),this.vrDefectRecordSvc.getDefectRecords(this.selectedProcess,this.activatedRoute.snapshot.queryParams.qaCard).subscribe(a=>{this.defectRecords=a})):this.toastr.warning("C\u1ea7n nh\u1eadp m\xe3 nh\xe2n vi\xean !","Warning")}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(j.tw),e.rXU(b.nX),e.rXU(w),e.rXU(k.X7))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-vr-defect-record-input"]],viewQuery:function(n,a){if(1&n&&(e.GBs(T,5),e.GBs(v.s,5)),2&n){let o;e.mGM(o=e.lsd())&&(a.infoIpt=o.first),e.mGM(o=e.lsd())&&(a.defectGrid=o.first)}},decls:62,vars:23,consts:[["infoTbl",""],["infoIpt",""],["defectGrid",""],["nzTitle","Nh\u1eadp d\u1eef li\u1ec7u Defect"],["nz-row","","nzJustify","start","nzAlign","middle",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","24","nzLg","24"],["id","infoTbl","nzBordered","","nzSize","small","nzFrontPagination","false",3,"nzData"],["id","infoIpt","nz-input","","nzSize","small","placeholder","Scan User ID, QA card","autocomplete","off",3,"keydown.enter","click","ngModelChange","ngModel"],["nz-col","","nzXs","24","nzSm","24","nzLg","24",2,"margin-top","-20px"],["id","defectGrid",3,"onSaving","dataSource","showColumnLines","showRowLines","showBorders","allowColumnResizing","columnAutoWidth","rowAlternationEnabled"],[3,"enabled"],["mode","batch",3,"allowUpdating","selectTextOnEditStart","startEditAction"],["location","before",2,"min-width","300px"],[2,"margin-bottom","5px","width","100%"],[2,"width","25%"],[3,"ngModelChange","ngModel"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["name","columnChooserButton"],["name","saveButton","location","after"],["dataField","processName","caption","H\u1ea1ng m\u1ee5c",3,"allowEditing"],["dataField","qty","caption","Qty","dataType","number"],["dataField","remark","caption","Ghi ch\xfa"],["nzTitle","T\u1ed5ng h\u1ee3p"],[3,"nzValue","nzLabel"]],template:function(n,a){if(1&n){const o=e.RV6();e.j41(0,"nz-tabset")(1,"nz-tab",3)(2,"div",4)(3,"div",5)(4,"nz-table",6,0)(6,"tbody")(7,"tr")(8,"td")(9,"label"),e.EFF(10,"Scanner"),e.k0s()(),e.j41(11,"td")(12,"input",7,1),e.bIt("keydown.enter",function(d){return e.eBV(o),e.Njj(a.scanInfo(d))})("click",function(){e.eBV(o);const d=e.sdS(13);return e.Njj(d.select())}),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(a.infoScan.user,d)||(a.infoScan.user=d),e.Njj(d)}),e.k0s()(),e.j41(14,"td")(15,"label"),e.EFF(16,"User ID"),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s()(),e.j41(19,"tr")(20,"td")(21,"label"),e.EFF(22,"Product"),e.k0s()(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"label"),e.EFF(27,"Line"),e.k0s()(),e.j41(28,"td"),e.EFF(29),e.k0s()(),e.j41(30,"tr")(31,"td")(32,"label"),e.EFF(33,"Date"),e.k0s()(),e.j41(34,"td"),e.EFF(35),e.k0s(),e.j41(36,"td")(37,"label"),e.EFF(38,"Shift"),e.k0s()(),e.j41(39,"td"),e.EFF(40),e.k0s()()()()(),e.j41(41,"div",8)(42,"dx-data-grid",9,2),e.bIt("onSaving",function(d){return e.eBV(o),e.Njj(a.onSaveHandler(d))}),e.nrm(44,"dxo-paging",10)(45,"dxo-editing",11),e.j41(46,"dxo-toolbar")(47,"dxi-item",12)(48,"table",13)(49,"thead")(50,"tr")(51,"th",14),e.EFF(52,"Process:"),e.k0s(),e.j41(53,"th")(54,"nz-select",15),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(a.selectedProcess,d)||(a.selectedProcess=d),e.Njj(d)}),e.bIt("ngModelChange",function(d){return e.eBV(o),e.Njj(a.onChangeProcess(d))}),e.DNE(55,U,1,2,"nz-option",16),e.k0s()()()()()(),e.nrm(56,"dxi-item",17)(57,"dxi-item",18),e.k0s(),e.nrm(58,"dxi-column",19)(59,"dxi-column",20)(60,"dxi-column",21),e.k0s()()()(),e.nrm(61,"nz-tab",22),e.k0s()}2&n&&(e.R7$(2),e.Y8G("nzGutter",24),e.R7$(2),e.Y8G("nzData",e.lJ4(22,A)),e.R7$(8),e.R50("ngModel",a.infoScan.user),e.R7$(6),e.JRh(a.infoScan.user),e.R7$(6),e.JRh(a.infoScan.model),e.R7$(5),e.JRh(a.infoScan.line),e.R7$(6),e.JRh(a.infoScan.date),e.R7$(5),e.JRh(a.infoScan.shift),e.R7$(2),e.Y8G("dataSource",a.defectRecords)("showColumnLines",!0)("showRowLines",!0)("showBorders",!0)("allowColumnResizing",!0)("columnAutoWidth",!1)("rowAlternationEnabled",!0),e.R7$(2),e.Y8G("enabled",!1),e.R7$(),e.Y8G("allowUpdating",!0)("selectTextOnEditStart",!0)("startEditAction","click"),e.R7$(9),e.R50("ngModel",a.selectedProcess),e.R7$(),e.Y8G("ngForOf",a.processes),e.R7$(3),e.Y8G("allowEditing",!1))},dependencies:[O.Sq,p.me,p.BC,p.vS,g.CP,g.SO,g._4,g.IL,g.aj,g.kt,f.Uq,f.e,R.Sy,m.ld,m.WI,v.s,C.nj_,C.$Xk,C.CVf,C.PVd,C.KOr,S.JZ,S.rE],styles:["nz-table[_ngcontent-%COMP%]{width:100%}nz-table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-left:-34px}nz-table[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]{vertical-align:top}nz-table[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#00f}nz-select[_ngcontent-%COMP%]{width:100%}"]})}return i})()}];let $=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[b.iI.forChild(G),b.iI]})}return i})();var H=s(97685);let L=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[O.MD,$,p.YN,g.$G,f.f3,R.j,m.DH,v.N,_.S,y,H.pc,I.L,S.hM]})}return i})()}}]);