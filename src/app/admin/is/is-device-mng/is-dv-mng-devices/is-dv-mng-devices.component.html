<nz-tabset [(nzSelectedIndex)]="selectedTabIndex">
  <nz-tab nzTitle="Danh sách thiết bị">
    <dx-data-grid
      keyExpr="id"
      #devicesGrid
      [dataSource]="devices"
      [showColumnLines]="true"
      [showRowLines]="true"
      [showBorders]="true"
      [allowColumnResizing]="true"
      [columnAutoWidth]="true"
      [rowAlternationEnabled]="false"
      [hoverStateEnabled]="true"
      (onCellPrepared)="onCellPreparedHistory($event)"
      (onExporting)="onExportDevices($event)"
      (onSelectionChanged)="onSelectionChanged($event)"
    >
      <dxo-header-filter [visible]="true"></dxo-header-filter>
      <dxo-filter-row [visible]="true"></dxo-filter-row>
      <dxo-export [enabled]="true"></dxo-export>

      <dxo-column-chooser
        #columnChooser
        [enabled]="true"
        [mode]="'select'"
        [title]="'Cột hiển thị'"
      >
      </dxo-column-chooser>

      <dxo-selection
        [selectAllMode]="'allPages'"
        [showCheckBoxesMode]="'always'"
        mode="multiple"
      ></dxo-selection>

      <dxo-toolbar>
        <dxi-item location="before">
          <nz-space>
            <dx-button
              *nzSpaceItem
              stylingMode="outlined"
              icon="plus"
              text="Thêm thiết bị"
              type="default"
              (onClick)="openDeviceCRUDModal()"
            >
            </dx-button>

            <ng-container *ngIf="selectedRows?.length">
              <dx-button
                *nzSpaceItem
                stylingMode="contained"
                icon="print"
                (onClick)="goToTab(2)"
                text="QR Code"
              >
              </dx-button>

              <ng-container *ngIf="selectedRows?.length">
                <dx-button
                  *nzSpaceItem
                  stylingMode="contained"
                  icon="refresh"
                  (onClick)="getDevices()"
                >
                </dx-button>
              </ng-container>
            </ng-container>
          </nz-space>
        </dxi-item>

        <dxi-item name="exportButton" location="after" />
        <dxi-item name="columnChooserButton" location="after"></dxi-item>
      </dxo-toolbar>

      <dxi-column
        dataField="name"
        caption="Tên thiết bị"
        cellTemplate="deviceNameTemplate"
        [fixed]="true"
        fixedPosition="left"
      >
        <dxo-header-filter [allowSelectAll]="true">
          <dxo-search [enabled]="true"></dxo-search>
        </dxo-header-filter>
      </dxi-column>
      <div *dxTemplate="let item of 'deviceNameTemplate'">
        <a (click)="openDeviceDetailModal(item.data)">{{ item.data.name }}</a>
      </div>
      <dxi-column dataField="type" caption="Loại thiết bị"></dxi-column>
      <dxi-column dataField="serial" caption="Serial"></dxi-column>
      <dxi-column dataField="model" caption="Model"></dxi-column>
      <dxi-column dataField="brand" caption="Thương hiệu"></dxi-column>
      <dxi-column dataField="os" caption="OS"></dxi-column>
      <dxi-column dataField="ram" caption="RAM"></dxi-column>
      <dxi-column
        dataField="faCode"
        caption="FA Code"
        [visible]="false"
      ></dxi-column>
      <dxi-column
        dataField="purchaseDate"
        caption="Ngày mua"
        dataType="date"
        format="yyyy-MM-dd"
        alignment="center"
      ></dxi-column>
      <dxi-column dataField="locationCode" caption="Vị trí"></dxi-column>
      <dxi-column
        dataField="status"
        caption="Trạng thái"
        [visible]="false"
      ></dxi-column>
      <dxi-column
        dataField="picCode"
        caption="PIC Code"
        [visible]="false"
        alignment="center"
      ></dxi-column>
      <dxi-column dataField="picName" caption="PIC Name"></dxi-column>
      <dxi-column dataField="sectionName" caption="Section"></dxi-column>
      <dxi-column
        dataField="recordTypeName"
        caption="Transaction Type"
      ></dxi-column>
      <dxi-column
        dataField="transactionDate"
        caption="Ngày Giao/Nhận"
        dataType="date"
        format="yyyy-MM-dd"
        alignment="center"
      ></dxi-column>
      <dxi-column
        dataField="expectedReturnDate"
        caption="Dự kiến trả"
        dataType="date"
        format="yyyy-MM-dd"
        alignment="center"
      ></dxi-column>

      <dxi-column
        caption="Action"
        cellTemplate="actionTemplate"
        [fixed]="true"
        fixedPosition="right"
        alignment="center"
      >
        <dxo-header-filter [allowSelectAll]="true">
          <dxo-search [enabled]="true"></dxo-search>
        </dxo-header-filter>
      </dxi-column>
      <div *dxTemplate="let item of 'actionTemplate'">
        <a (click)="openDeviceCRUDModal(item.data)">Edit</a>
      </div>

      <dxi-column
        dataField="remark"
        caption="Ghi chú"
        [visible]="true"
      ></dxi-column>

      <dxo-summary>
        <dxi-total-item
          column="name"
          summaryType="count"
          displayFormat="Tổng: {0} (Thiết bị)"
        ></dxi-total-item>
      </dxo-summary>

      <dxo-paging [pageSize]="10"></dxo-paging>
      <dxo-pager
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[10, 15, 25, 50, 100]"
      >
      </dxo-pager>
    </dx-data-grid>
  </nz-tab>
  <nz-tab nzTitle="Lịch sử giao nhận">
    <dx-data-grid
      keyExpr="id"
      #transactionGrid
      [dataSource]="transactions"
      [showColumnLines]="true"
      [showRowLines]="true"
      [showBorders]="true"
      [allowColumnResizing]="true"
      [columnAutoWidth]="true"
      [rowAlternationEnabled]="false"
      [hoverStateEnabled]="true"
      (onCellPrepared)="onCellPreparedHistory($event)"
    >
      <dxo-header-filter [visible]="true"></dxo-header-filter>
      <dxo-filter-row [visible]="true"></dxo-filter-row>
      <dxo-export [enabled]="true"></dxo-export>

      <dxo-column-chooser
        #columnChooser
        [enabled]="true"
        [mode]="'select'"
        [title]="'Cột hiển thị'"
      >
      </dxo-column-chooser>

      <dxo-toolbar>
        <dxi-item location="before">
          <nz-space>
            <dx-button
              *nzSpaceItem
              stylingMode="outlined"
              icon="plus"
              text="Thêm giao dịch"
              type="default"
              (onClick)="openTransactionModal({})"
            >
            </dx-button>
          </nz-space>
        </dxi-item>
        <dxi-item location="after">
          <dx-date-range-box
            id="range-date"
            style="margin-top: -5px"
            [displayFormat]="'yyyy/MM/dd'"
            style="width: 300px"
            startDateLabel="Trans Date (Start)"
            endDateLabel="Trans Date (End)"
            labelMode="static"
          >
          </dx-date-range-box>
        </dxi-item>

        <dxi-item name="exportButton" location="after" />
        <dxi-item name="columnChooserButton" location="after"></dxi-item>
      </dxo-toolbar>

      <dxi-column dataField="deviceName" caption="Tên thiết bị" fixed="true">
        <dxi-validation-rule
          type="required"
          message="Tên thiết bị bắt buộc chọn"
        ></dxi-validation-rule>
      </dxi-column>
      <dxi-column
        dataField="recordType"
        caption="Loại giao dich"
        [visible]="false"
      >
        <dxi-validation-rule
          type="required"
          message="Loại giao dich bắt buộc chọn"
        ></dxi-validation-rule>
      </dxi-column>
      <dxi-column dataField="recordTypeName" caption="Loại giao dich">
      </dxi-column>
      <dxi-column
        dataField="itUserCode"
        caption="IT UserCode"
        [visible]="false"
      ></dxi-column>
      <dxi-column
        dataField="itUserName"
        caption="IT Name"
        [visible]="false"
      ></dxi-column>
      <dxi-column
        dataField="picCode"
        caption="PIC Code"
        [visible]="false"
      ></dxi-column>
      <dxi-column dataField="picName" caption="PIC Name"></dxi-column>
      <dxi-column dataField="locationCode" caption="Vị trí"></dxi-column>

      <dxi-column dataField="picSectionName" caption="Section"></dxi-column>
      <dxi-column
        dataField="picSectionCode"
        caption="Section (Code)"
        [visible]="false"
      ></dxi-column>

      <dxi-column
        dataField="picSubsectionName"
        caption="Subsection"
      ></dxi-column>
      <dxi-column
        dataField="picSubsectionCode"
        caption="Subsection (Code)"
        [visible]="false"
      ></dxi-column>

      <dxi-column
        dataField="date"
        caption="Ngày Giao/Nhận"
        dataType="date"
        format="yyyy-MM-dd"
        alignment="center"
      ></dxi-column>
      <dxi-column
        dataField="expectedReturnDate"
        caption="Dự kiến trả"
        dataType="date"
        format="yyyy-MM-dd"
        alignment="center"
      ></dxi-column>

      <dxi-column dataField="remark" caption="Remark"></dxi-column>

      <dxi-column
        caption="Action"
        cellTemplate="actionTemplate"
        [fixed]="true"
        fixedPosition="right"
        alignment="center"
        [visible]="false"
      >
      </dxi-column>
      <div *dxTemplate="let item of 'actionTemplate'">
        <a (click)="openTransactionModal(item.data)">Sửa</a>
      </div>

      <dxo-paging [pageSize]="12"></dxo-paging>
      <dxo-pager
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[10, 25, 50, 100]"
      >
      </dxo-pager>
    </dx-data-grid>
  </nz-tab>
  <nz-tab nzTitle="Tem thiết bị" *ngIf="selectedRows?.length">
    <nz-space>
      <button
        *nzSpaceItem
        nz-button
        nzType="primary"
        printSectionId="printLabel"
        ngxPrint
        [useExistingCss]="true"
      >
        <span nz-icon nzType="printer"></span>
        Print
      </button>
    </nz-space>

    <nz-divider style="margin: 2px 0px"></nz-divider>

    <div id="printLabel">
      <table
        class="label"
        style="width: 5.2cm"
        *ngFor="let label of selectedRows"
      >
        <tbody>
          <tr>
            <td style="text-align: center; font-weight: bold; width: 22%">
              PIDVN
            </td>
            <td style="width: 25%">Code</td>
            <td>{{ label.name }}</td>
          </tr>
          <tr>
            <td rowspan="3" style="text-align: center">
              <qrcode
                [qrdata]="label.name"
                [allowEmptyString]="true"
                [cssClass]="'center'"
                [elementType]="'img'"
                [errorCorrectionLevel]="'Q'"
                [margin]="1"
                [scale]="1"
                [width]="35"
                style="float: left"
              ></qrcode>
            </td>
            <td>Model</td>
            <td>{{ label.model }}</td>
          </tr>
          <tr>
            <td>Start Date</td>
            <td>{{ label.purchaseDate | date : "yyyy-MM-dd" }}</td>
          </tr>
          <tr>
            <td>Serial</td>
            <td>{{ label.serial }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </nz-tab>
</nz-tabset>

<!-- Modal Thông tin giao dịch -->
<nz-modal
  nzDraggable
  nzCentered
  [(nzVisible)]="isOpenTransactionModal"
  nzTitle="Thông tin giao dịch"
  (nzOnCancel)="isOpenTransactionModal = false"
  [nzWidth]="'60vw'"
>
  <ng-container *nzModalContent>
    <dx-validation-group #transactionFormValidator>
      <nz-table
        [nzData]="['']"
        nzBordered
        nzSize="small"
        [nzFrontPagination]="false"
      >
        <tbody>
          <tr>
            <td><label>Loại giao dịch</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="name"
                valueExpr="id"
                [dataSource]="recordTypes"
                [showClearButton]="true"
                placeholder="Chọn loại giao dịch"
                [(value)]="transactionSelected.recordType"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Loại giao dịch"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
            <td><label>Người giao dịch</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="codeName"
                valueExpr="username"
                [dataSource]="users"
                [showClearButton]="true"
                [(value)]="transactionSelected.picCode"
                [searchEnabled]="true"
                placeholder="Chọn người giao dịch"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Người giao dịch"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
          </tr>
          <tr>
            <td><label>Tên thiết bị</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                [displayExpr]="displayDeviceName"
                valueExpr="name"
                [dataSource]="devices"
                [showClearButton]="true"
                placeholder="Chọn thiết bị"
                [(value)]="transactionSelected.deviceName"
                [searchEnabled]="true"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Tên thiết bị"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
            <td><label>Vị trí</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="name"
                valueExpr="code"
                [dataSource]="locations"
                [showClearButton]="true"
                placeholder="Chọn vị trí"
                [(value)]="transactionSelected.locationCode"
                [searchEnabled]="true"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Vị trí"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
          </tr>
          <tr>
            <td><label>Dự kiến trả</label></td>
            <td>
              <dx-date-box
                [min]="today"
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                [displayFormat]="'yyyy-MM-dd'"
                [showClearButton]="true"
                placeholder="Ngày trả (Dự kiến)"
                [(value)]="transactionSelected.expectedReturnDate"
              ></dx-date-box>
            </td>
            <td><label>Remark</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                [(value)]="transactionSelected.remark"
              ></dx-text-box>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </dx-validation-group>
  </ng-container>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="isOpenTransactionModal = false">
      Đóng
    </button>
    <button
      nz-button
      nzType="primary"
      (click)="saveTransaction()"
      [nzLoading]="isLoading"
    >
      Lưu
    </button>
  </div>
</nz-modal>

<!-- Modal Thông tin thiết bị -->
<nz-modal
  [(nzVisible)]="isOpenDeviceDetailModal"
  nzTitle="Thông tin thiết bị"
  (nzOnCancel)="isOpenDeviceDetailModal = false"
  (nzOnOk)="isOpenDeviceDetailModal = false"
  [nzWidth]="'100vw'"
  [nzStyle]="{ top: '5vh' }"
  [nzBodyStyle]="{ height: '80vh', overflow: 'auto' }"
>
  <ng-container *nzModalContent>
    <div nz-row nzJustify="start" nzAlign="top" [nzGutter]="24">
      <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12">
        <nz-divider
          nzText="Device Infomation"
          nzOrientation="left"
          style="margin-top: -20px"
          nzPlain="true"
        ></nz-divider>
        <nz-table
          #deviceInfoTable
          nzSize="small"
          nzBordered
          [nzData]="['']"
          nzFrontPagination="false"
        >
          <tbody>
            <tr>
              <td style="width: 20%"><label>Tên thiết bị</label></td>
              <td style="width: 20%">{{ deviceSelected?.name }}</td>
              <td
                rowspan="4"
                colspan="2"
                style="text-align: center; vertical-align: middle"
              >
                <img
                  *ngIf="deviceSelected.type === 'LAPTOP'"
                  nz-image
                  nzSrc="../../../../../assets/images/devices/LAPTOP.png"
                  width="25%"
                />
                <img
                  *ngIf="deviceSelected.type === 'PC-AIO'"
                  nz-image
                  nzSrc="../../../../../assets/images/devices/PC-AIO.png"
                  width="25%"
                />
                <img
                  *ngIf="deviceSelected.type === 'PC'"
                  nz-image
                  nzSrc="../../../../../assets/images/devices/PC.jpg"
                  width="25%"
                />
              </td>
            </tr>
            <tr>
              <td><label>Model</label></td>
              <td>{{ deviceSelected?.model }}</td>
            </tr>
            <tr>
              <td><label>Loại thiết bị</label></td>
              <td>{{ deviceSelected?.type }}</td>
            </tr>
            <tr>
              <td><label>Thương hiệu</label></td>
              <td>{{ deviceSelected?.brand }}</td>
            </tr>
            <tr>
              <td><label>Ngày mua</label></td>
              <td>{{ deviceSelected?.purchaseDate | date : "yyyy-MM-dd" }}</td>
              <td><label>FA Code</label></td>
              <td>
                {{ deviceSelected?.faCode ? deviceSelected?.faCode : "N/A" }}
              </td>
            </tr>
            <tr>
              <td><label>Hệ điều hành</label></td>
              <td>{{ deviceSelected?.os }}</td>
              <td><label>Serial</label></td>
              <td>
                {{ deviceSelected?.serial ? deviceSelected?.serial : "N/A" }}
              </td>
            </tr>
            <tr>
              <td><label>Remark</label></td>
              <td colspan="3">{{ deviceSelected?.remark }}</td>
            </tr>
          </tbody>
        </nz-table>
        <nz-divider
          *ngIf="deviceSelected.transactionId"
          nzText="Transction Infomation"
          nzOrientation="left"
          style="margin-top: -20px"
          nzPlain="true"
        ></nz-divider>
        <nz-table
          *ngIf="deviceSelected.transactionId"
          #transactionInfoTable
          nzSize="small"
          nzBordered
          [nzData]="['']"
          nzFrontPagination="false"
        >
          <tbody>
            <tr>
              <td><label>Giao dịch</label></td>
              <td>{{ deviceSelected?.recordTypeName }}</td>
              <td><label>Ngày Giao/Nhận</label></td>
              <td>
                {{ deviceSelected?.transactionDate | date : "yyyy-MM-dd" }}
              </td>
            </tr>
            <tr>
              <td><label>P.I.C</label></td>
              <td nz-tooltip [nzTooltipTitle]="titleTemplatePICUser">
                {{ deviceSelected?.picName }}
              </td>
              <ng-template #titleTemplatePICUser>
                <ul style="margin-left: -25px">
                  <li>Tên nhân viên: {{ deviceSelected?.picName }}</li>
                  <li>Mã nhân viên: {{ deviceSelected?.picCode }}</li>
                  <li>Bộ phận: {{ deviceSelected?.sectionName }}</li>
                </ul>
              </ng-template>
              <td><label>Vị trí</label></td>
              <td>{{ deviceSelected?.locationCode }}</td>
            </tr>
            <tr>
              <td><label>IT User</label></td>
              <td nz-tooltip [nzTooltipTitle]="titleTemplateItUser">
                {{ deviceSelected?.itUserName }}
              </td>
              <ng-template #titleTemplateItUser>
                <ul style="margin-left: -25px">
                  <li>Tên nhân viên: {{ deviceSelected?.itUserName }}</li>
                  <li>Mã nhân viên: {{ deviceSelected?.itUserCode }}</li>
                  <li>Bộ phận: IT</li>
                </ul>
              </ng-template>
              <td><label>Dự kiến trả</label></td>
              <td>
                {{ deviceSelected?.expectedReturnDate | date : "yyyy-MM-dd" }}
              </td>
            </tr>
            <tr>
              <td><label>Remark</label></td>
              <td colspan="3">{{ deviceSelected?.transactionRemark }}</td>
            </tr>
          </tbody>
        </nz-table>
      </div>
      <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12">
        <nz-divider
          nzText="License Infomation"
          nzOrientation="left"
          style="margin-top: -20px"
          nzPlain="true"
        ></nz-divider>
        <dx-data-grid
          keyExpr="id"
          #devicesGrid
          [dataSource]="[]"
          [showColumnLines]="true"
          [showRowLines]="true"
          [showBorders]="true"
          [allowColumnResizing]="true"
          [columnAutoWidth]="true"
          [rowAlternationEnabled]="false"
          [hoverStateEnabled]="true"
          style="margin-top: -20px"
        >
          <dxo-header-filter [visible]="true"></dxo-header-filter>
          <dxo-filter-row [visible]="true"></dxo-filter-row>
          <dxo-export [enabled]="true"></dxo-export>
          <dxo-column-chooser #columnChooser [enabled]="true" [mode]="'select'">
          </dxo-column-chooser>

          <dxi-column dataField="name" caption="Phần mềm"></dxi-column>
          <dxi-column dataField="startDate" caption="Ngày bắt đầu"></dxi-column>
          <dxi-column dataField="endDate" caption="Ngày kết thúc"></dxi-column>
        </dx-data-grid>
      </div>
    </div>
  </ng-container>
</nz-modal>

<!-- Modal Thông tin thiết bị (CRUD) -->
<nz-modal
  [(nzVisible)]="isOpenDeviceCRUDModal"
  [nzTitle]="titleDeviceCRUDModal"
  (nzOnCancel)="isOpenDeviceCRUDModal = false"
  [nzWidth]="'60vw'"
  nzDraggable
>
  <ng-container *nzModalContent>
    <dx-validation-group #deviceFormValidator>
      <nz-table
        [nzData]="['']"
        nzBordered
        nzSize="small"
        [nzFrontPagination]="false"
      >
        <tbody>
          <tr>
            <td><label>Tên thiết bị</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                placeholder="ex: 27535-HQ9PH74"
                [(value)]="deviceSelected.name"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần nhập tên thiết bị"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-text-box>
            </td>
            <td><label>Loại thiết bị</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="code"
                valueExpr="name"
                [dataSource]="[
                  { code: 'LAPTOP', name: 'LAPTOP' },
                  { code: 'PC', name: 'PC' },
                  { code: 'PC-AIO', name: 'PC-AIO' },
                  { code: 'TABLET', name: 'TABLET' }
                ]"
                [showClearButton]="true"
                [searchEnabled]="true"
                placeholder="Chọn loại thiết bị"
                [(value)]="deviceSelected.type"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Người giao dịch"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
          </tr>
          <tr>
            <td><label>Serial</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                [placeholder]="'Nhập Serial thiết bị'"
                [(value)]="deviceSelected.serial"
              >
              </dx-text-box>
            </td>
            <td><label>Model</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                placeholder="ex: Dell Latitude 3520 "
                [(value)]="deviceSelected.model"
              ></dx-text-box>
            </td>
          </tr>
          <tr>
            <td><label>PUR Date</label></td>
            <td>
              <dx-date-box
                [max]="today"
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                [displayFormat]="'yyyy-MM-dd'"
                [showClearButton]="true"
                placeholder="Chọn ngày mua"
                [(value)]="deviceSelected.purchaseDate"
              ></dx-date-box>
            </td>
            <td><label>OS</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                placeholder="Nhập hệ điều hành"
                [(value)]="deviceSelected.os"
              ></dx-text-box>
            </td>
          </tr>
          <tr>
            <td><label>RAM</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                placeholder="Nhập thông tin RAM"
                [(value)]="deviceSelected.ram"
              ></dx-text-box>
            </td>
            <td><label>Vị trí</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="code"
                valueExpr="code"
                [dataSource]="locations"
                [showClearButton]="true"
                placeholder="Chọn vị trí"
                [searchEnabled]="true"
                [(value)]="deviceSelected.locationCode"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn Vị trí"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
          </tr>
          <tr>
            <td><label>PIC Code</label></td>
            <td>
              <dx-select-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'floating'"
                displayExpr="codeName"
                valueExpr="username"
                [dataSource]="users"
                [showClearButton]="true"
                [(value)]="deviceSelected.picCode"
                [searchEnabled]="true"
                placeholder="Chọn P.I.C"
              >
                <dx-validator>
                  <dxi-validation-rule
                    type="required"
                    message="Cần chọn P.I.C"
                  ></dxi-validation-rule>
                </dx-validator>
              </dx-select-box>
            </td>
            <td><label>Remark</label></td>
            <td>
              <dx-text-box
                labelLocation="left"
                showColonAfterLabel="true"
                [labelMode]="'static'"
                placeholder="Nhập ghi chú"
                [(value)]="deviceSelected.remark"
              ></dx-text-box>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </dx-validation-group>
  </ng-container>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="isOpenDeviceCRUDModal = false">
      Đóng
    </button>
    <button
      nz-button
      nzType="primary"
      (click)="saveDevice()"
      [nzLoading]="isLoading"
    >
      Lưu
    </button>
  </div>
</nz-modal>
